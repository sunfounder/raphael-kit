 
.. note::

    Bonjour et bienvenue dans la CommunautÃ© Facebook des passionnÃ©s de Raspberry Pi, Arduino et ESP32 de SunFounder ! Plongez plus profondÃ©ment dans l'univers des Raspberry Pi, Arduino et ESP32 avec d'autres passionnÃ©s.

    **Pourquoi rejoindre ?**

    - **Support d'experts** : RÃ©solvez les problÃ¨mes aprÃ¨s-vente et les dÃ©fis techniques avec l'aide de notre communautÃ© et de notre Ã©quipe.
    - **Apprendre et partager** : Ã‰changez des astuces et des tutoriels pour amÃ©liorer vos compÃ©tences.
    - **AperÃ§us exclusifs** : AccÃ©dez en avant-premiÃ¨re aux annonces de nouveaux produits et aux aperÃ§us.
    - **RÃ©ductions spÃ©ciales** : Profitez de rÃ©ductions exclusives sur nos produits les plus rÃ©cents.
    - **Promotions festives et cadeaux** : Participez Ã  des cadeaux et des promotions de vacances.

    ğŸ‘‰ PrÃªt Ã  explorer et Ã  crÃ©er avec nous ? Cliquez [|link_sf_facebook|] et rejoignez-nous aujourd'hui !

.. _3.1.10_c_pi5:

3.1.10 GÃ©nÃ©rateur de Code Morse
=====================================

Introduction
-----------------

Dans ce projet, nous allons fabriquer un gÃ©nÃ©rateur de code Morse, oÃ¹ vous tapez une sÃ©rie de
 lettres anglaises sur le Raspberry Pi pour les faire apparaÃ®tre en code Morse.

Composants nÃ©cessaires
------------------------------

Dans ce projet, nous avons besoin des composants suivants.

.. image:: ../img/list_Morse_Code_Generator.png
    :align: center

Il est trÃ¨s pratique d'acheter un kit complet, voici le lien :

.. list-table::
    :widths: 20 20 20
    :header-rows: 1

    *   - Nom
        - Ã‰LÃ‰MENTS DANS CE KIT
        - LIEN
    *   - Kit Raphael
        - 337
        - |link_Raphael_kit|

Vous pouvez Ã©galement les acheter sÃ©parÃ©ment via les liens ci-dessous.

.. list-table::
    :widths: 30 20
    :header-rows: 1

    *   - INTRODUCTION DU COMPOSANT
        - LIEN D'ACHAT

    *   - :ref:`cpn_gpio_extension_board`
        - |link_gpio_board_buy|
    *   - :ref:`cpn_breadboard`
        - |link_breadboard_buy|
    *   - :ref:`cpn_wires`
        - |link_wires_buy|
    *   - :ref:`cpn_resistor`
        - |link_resistor_buy|
    *   - :ref:`cpn_led`
        - |link_led_buy|
    *   - :ref:`cpn_buzzer`
        - \-
    *   - :ref:`cpn_transistor`
        - |link_transistor_buy|

SchÃ©ma de cÃ¢blage
-----------------------

============ ======== ======== ===
Nom T-Board  physique wiringPi BCM
GPIO17       Pin 11   0        17
GPIO22       Pin 15   3        22
============ ======== ======== ===

.. image:: ../img/Schematic_three_one11.png
   :align: center

ProcÃ©dures expÃ©rimentales
----------------------------

**Ã‰tape 1 :** Construisez le circuit. (Faites attention aux pÃ´les du buzzer : 
Celui avec le label + est le pÃ´le positif et l'autre est le pÃ´le nÃ©gatif.)

.. image:: ../img/image269.png

**Ã‰tape 2 :** Ouvrez le fichier de code.

.. raw:: html

   <run></run>

.. code-block:: 

    cd ~/raphael-kit/c/3.1.10/

**Ã‰tape 3 :** Compilez le code.

.. raw:: html

   <run></run>

.. code-block:: 

    gcc 3.1.10_MorseCodeGenerator.c -lwiringPi

**Ã‰tape 4 :** ExÃ©cutez le fichier exÃ©cutable ci-dessus.

.. raw:: html

   <run></run>

.. code-block:: 

    sudo ./a.out

AprÃ¨s l'exÃ©cution du programme, tapez une sÃ©rie de caractÃ¨res, et le buzzer ainsi que la
 LED enverront les signaux correspondants en code Morse.

.. note::

    Si cela ne fonctionne pas aprÃ¨s l'exÃ©cution, ou s'il y a un message d'erreur : "wiringPi.h: No such file or directory", veuillez vous rÃ©fÃ©rer Ã  :ref:`install_wiringpi`.
**Explication du code**

.. code-block:: c

    structÂ MORSE{
    Â Â Â Â charÂ word;
    Â Â Â Â unsignedÂ charÂ *code;
    };

    structÂ MORSEÂ morseDict[]=
    {
    Â Â Â Â {'A',"01"},Â {'B',"1000"},Â {'C',"1010"},Â {'D',"100"},Â {'E',"0"},Â 
    Â Â Â Â {'F',"0010"},Â {'G',"110"},Â {'H',"0000"},Â {'I',"00"},Â {'J',"0111"},Â 
    Â Â Â Â {'K',"101"},Â {'L',"0100"},Â {'M',"11"},Â {'N',"10"},Â {'O',"111"},Â 
    Â Â Â Â {'P',"0110"},Â {'Q',"1101"},Â {'R',"010"},Â {'S',"000"},Â {'T',"1"},
    Â Â Â Â {'U',"001"},Â {'V',"0001"},Â {'W',"011"},Â {'X',"1001"},Â {'Y',"1011"},Â 
    Â Â Â Â {'Z',"1100"},{'1',"01111"},Â {'2',"00111"},Â {'3',"00011"},Â {'4',"00001"},Â 
    Â Â Â Â {'5',"00000"},{'6',"10000"},Â {'7',"11000"},Â {'8',"11100"},Â {'9',"11110"},
    Â Â Â Â {'0',"11111"},{'?',"001100"},Â {'/',"10010"},Â {',',"110011"},Â {'.',"010101"},
    Â Â Â Â {';',"101010"},{'!',"101011"},Â {'@',"011010"},Â {':',"111000"}
    };

Cette structure MORSE est le dictionnaire du code Morse, contenant les caractÃ¨res A-Z, 
les chiffres 0-9 et les signes â€œ?â€ â€œ/â€ â€œ:â€ â€œ,â€ â€œ.â€ â€œ;â€ â€œ!â€ â€œ@â€.

.. code-block:: c

    charÂ *lookup(charÂ key,structÂ MORSEÂ *dict,intÂ length)
    {
    Â Â Â Â forÂ (intÂ i=0;i<length;i++)
        {
            if(dict[i].word==key){
    Â Â Â Â Â Â Â Â Â Â Â Â returnÂ dict[i].code;
            }
        }    
    }

La fonction ``lookup()`` fonctionne en â€œconsultant le dictionnaireâ€. 
Elle dÃ©finit une ``key``, recherche les mots identiques Ã  ``key`` dans la structure ``morseDict`` 
et renvoie les informations correspondantesâ€”``code`` du mot certain.

.. code-block:: c

    voidÂ on(){
        digitalWrite(ALedPin,HIGH);
        digitalWrite(BeepPin,HIGH);     
    }

Create a function ``on()`` to start the buzzer and the LED.

.. code-block:: c

    voidÂ off(){
        digitalWrite(ALedPin,LOW);
        digitalWrite(BeepPin,LOW);
    }

The function ``off()`` turns off the buzzer and the LED.

.. code-block:: c

    voidÂ beep(intÂ dt){
        on();
        delay(dt);
        off();
        delay(dt);
    }

Define a function ``beep()`` to make the buzzer and the LED emit sounds and
blink in a certain interval of **dt**.

.. code-block:: c

    voidÂ morsecode(charÂ *code){
    Â Â Â Â intÂ pauseÂ =Â 250;
    Â Â Â Â charÂ *pointÂ =Â NULL;
    Â Â Â Â intÂ lengthÂ =Â sizeof(morseDict)/sizeof(morseDict[0]);
    Â Â Â Â forÂ (intÂ i=0;i<strlen(code);i++)
        {
            point=lookup(code[i],morseDict,length);
    Â Â Â Â Â Â Â Â forÂ (intÂ j=0;j<strlen(point);j++){
    Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (point[j]=='0')
                {
                    beep(pause/2);
    Â Â Â Â Â Â Â Â Â Â Â Â }elseÂ if(point[j]=='1')
                {
                    beep(pause);
                }
                delay(pause);
            }
        }
    }

La fonction ``morsecode()`` est utilisÃ©e pour traiter le code Morse des caractÃ¨res saisis en 
faisant en sorte que le â€œ1â€ du code continue d'Ã©mettre des sons ou des lumiÃ¨res et que le â€œ0â€ 
Ã©mette des sons ou des lumiÃ¨res briÃ¨vement. Par exemple, en saisissant â€œSOSâ€, un signal contenant 
trois courts, trois longs, puis trois courts segments â€œ Â· Â· Â· - - - Â· Â· Â· â€ sera Ã©mis.

.. code-block:: c

    intÂ toupper(intÂ c)
    {
    Â Â Â Â ifÂ ((cÂ >=Â 'a')Â &&Â (cÂ <=Â 'z'))
    Â Â Â Â Â Â Â Â returnÂ cÂ +Â ('A'Â -Â 'a');
    Â Â Â Â returnÂ c;
    }
    charÂ *strupr(charÂ *str)
    {
    Â Â Â Â charÂ *orign=str;
    Â Â Â Â forÂ (;Â *str!='\0';Â str++)
    Â Â Â Â Â Â Â Â *strÂ =Â toupper(*str);
    returnÂ orign;
    }

Avant de coder, il faut unifier les lettres en majuscules.

.. code-block:: c

    voidÂ main(){
        setup();
    Â Â Â Â charÂ *code;
    Â Â Â Â intÂ length=8;
    Â Â Â Â codeÂ =Â (char*)malloc(sizeof(char)*length);
    Â Â Â Â whileÂ (1){
    Â Â Â Â Â Â Â Â printf("PleaseÂ inputÂ theÂ messenger:");
            scanf("%s",code);
            code=strupr(code);
            printf("%s\n",code);
            morsecode(code);
        }
    }

Lorsque vous tapez les caractÃ¨res pertinents avec le clavier, ``code=strupr(code)`` convertit les lettres saisies en majuscules.

``Printf()`` imprime ensuite le texte clair sur l'Ã©cran de l'ordinateur, et la fonction ``morsecod()`` fait en sorte que le buzzer et la LED Ã©mettent le code Morse.

Notez que la longueur du caractÃ¨re saisi ne doit pas dÃ©passer la 
**length** (qui peut Ãªtre rÃ©visÃ©e).

Image du phÃ©nomÃ¨ne
-----------------------

.. image:: ../img/image270.jpeg
   :align: center