 
.. note::

    Bonjour et bienvenue dans la Communaut√© Facebook des passionn√©s de Raspberry Pi, Arduino et ESP32 de SunFounder ! Plongez plus profond√©ment dans l'univers des Raspberry Pi, Arduino et ESP32 avec d'autres passionn√©s.

    **Pourquoi rejoindre ?**

    - **Support d'experts** : R√©solvez les probl√®mes apr√®s-vente et les d√©fis techniques avec l'aide de notre communaut√© et de notre √©quipe.
    - **Apprendre et partager** : √âchangez des astuces et des tutoriels pour am√©liorer vos comp√©tences.
    - **Aper√ßus exclusifs** : Acc√©dez en avant-premi√®re aux annonces de nouveaux produits et aux aper√ßus.
    - **R√©ductions sp√©ciales** : Profitez de r√©ductions exclusives sur nos produits les plus r√©cents.
    - **Promotions festives et cadeaux** : Participez √† des cadeaux et des promotions de vacances.

    üëâ Pr√™t √† explorer et √† cr√©er avec nous ? Cliquez [|link_sf_facebook|] et rejoignez-nous aujourd'hui !

.. _1.3.1_js:

1.3.1 Moteur
=================

Introduction
-----------------

Dans ce projet, nous apprendrons √† utiliser le L293D pour piloter un moteur √† courant continu 
(DC) et le faire tourner dans le sens horaire et antihoraire. Comme le moteur DC n√©cessite un 
courant plus important, par mesure de s√©curit√©, nous utilisons ici le module d'alimentation pour 
alimenter les moteurs.

Composants N√©cessaires
-------------------------------

Pour ce projet, nous avons besoin des composants suivants. 

.. image:: ../img/list_1.3.1.png

Il est vraiment pratique d'acheter un kit complet, voici le lien : 

.. list-table::
    :widths: 20 20 20
    :header-rows: 1

    *   - Nom	
        - ARTICLES DANS CE KIT
        - LIEN
    *   - Kit Raphael
        - 337
        - |link_Raphael_kit|

Vous pouvez √©galement les acheter s√©par√©ment via les liens ci-dessous.

.. list-table::
    :widths: 30 20
    :header-rows: 1

    *   - INTRODUCTION DU COMPOSANT
        - LIEN D'ACHAT

    *   - :ref:`cpn_gpio_extension_board`
        - |link_gpio_board_buy|
    *   - :ref:`cpn_breadboard`
        - |link_breadboard_buy|
    *   - :ref:`cpn_wires`
        - |link_wires_buy|
    *   - :ref:`cpn_power_module`
        - \-
    *   - :ref:`cpn_l293d`
        - \-
    *   - :ref:`cpn_motor`
        - |link_motor_buy|

Sch√©ma de C√¢blage
--------------------

Branchez le module d'alimentation sur la breadboard, et ins√©rez le cavalier sur la broche 5V, 
il d√©livrera alors une tension de 5V. Connectez la broche 1 du L293D au GPIO22 et r√©glez-la √† 
un niveau haut. Connectez la broche 2 au GPIO27 et la broche 7 au GPIO17, puis r√©glez une broche 
sur haut et l'autre sur bas. Ainsi, vous pouvez changer le sens de rotation du moteur.

.. image:: ../img/image336.png


**Proc√©dures Exp√©rimentales**

**√âtape 1 :** Construisez le circuit.

.. image:: ../img/image117.png


.. note::
    Le module d'alimentation peut utiliser une batterie de 9V avec la boucle de batterie de 9V 
    incluse dans le kit. Ins√©rez le cavalier du module d'alimentation dans les bandes de bus de 
    5V de la breadboard.

.. image:: ../img/image118.jpeg

**√âtape 2 :** Allez dans le dossier du code.

.. raw:: html

   <run></run>

.. code-block::

    cd ~/raphael-kit/nodejs/

**√âtape 4 :** Ex√©cutez le code.

.. raw:: html

   <run></run>

.. code-block::

    sudo node motor.js

Lorsque le code s'ex√©cute, le moteur tourne d'abord dans le sens horaire pendant 1 seconde puis 
s'arr√™te pendant 1 seconde, apr√®s cela, il tourne dans le sens antihoraire pendant 1 seconde ; 
ensuite, le moteur s'arr√™te pendant 1 seconde. Cette s√©rie d'actions sera ex√©cut√©e en boucle.


**Code**

.. code-block:: js

    const Gpio = require('pigpio').Gpio;

    MotorPin1 = new Gpio(17, { mode: Gpio.OUTPUT });
    MotorPin2 = new Gpio(27, { mode: Gpio.OUTPUT });
    MotorEnable = new Gpio(22, { mode: Gpio.OUTPUT });


    // Define a motor function to spin the motor
    // direction should be
    // 2(clockwise), 1(counterclockwise), 0(stop)
    function motor(direction) {
        switch (direction) {
            case 2: // Clockwise
                // Set direction
                MotorPin1.digitalWrite(1)
                MotorPin2.digitalWrite(0)
                // Enable the motor
                MotorEnable.digitalWrite(1)
                console.log('Clockwise')
                break;
            case 1:  // Counterclockwise
                // Set direction
                MotorPin1.digitalWrite(0)
                MotorPin2.digitalWrite(1)
                // Enable the motor
                MotorEnable.digitalWrite(1)
                console.log('Counterclockwise')
                break;
            case 0: // Stop
                // Disable the motor
                MotorEnable.digitalWrite(0)
                console.log('Stop')

        }
    }

    process.on('SIGINT', function () {
        MotorEnable.digitalWrite(0)
        process.exit();
    })

    let index=-1
    setInterval(() => {
        index=(index+1)%3
        motor(index)
    }, 1000)    


**Explication du Code**

.. code-block:: js

    MotorPin1 = new Gpio(17, { mode: Gpio.OUTPUT });
    MotorPin2 = new Gpio(27, { mode: Gpio.OUTPUT });
    MotorEnable = new Gpio(22, { mode: Gpio.OUTPUT });

Importer le module pigpio et cr√©er trois objets de la classe Gpio pour contr√¥ler les trois ports IO de Gpio17, Gpio27 et Gpio22.

.. code-block:: js

    function motor(direction) {
        switch (direction) {
            case 2: // Clockwise
                // Set direction
                MotorPin1.digitalWrite(1)
                MotorPin2.digitalWrite(0)
                // Enable the motor
                MotorEnable.digitalWrite(1)
                console.log('Clockwise')
                break;
            case 1:  // Counterclockwise
                // Set direction
                MotorPin1.digitalWrite(0)
                MotorPin2.digitalWrite(1)
                // Enable the motor
                MotorEnable.digitalWrite(1)
                console.log('Counterclockwise')
                break;
            case 0: // Stop
                // Disable the motor
                MotorEnable.digitalWrite(0)
                console.log('Stop')

        }
    }

D√©finir une fonction motor() pour contr√¥ler le moteur,

#. Lorsque la direction est √©gale √† 2, le port MotorPin1 √©crit un niveau haut, le port MotorPin2 √©crit un niveau bas, et le port d'activation MotorEnable √©crit un niveau haut, et le moteur tourne dans le sens horaire.
#. Lorsque la direction est √©gale √† 1, le port MotorPin1 √©crit un niveau bas, le port MotorPin2 √©crit un niveau haut, et le port d'activation MotorEnable √©crit un niveau haut, et le moteur tourne dans le sens antihoraire.
#. Lorsque la direction est √©gale √† 0, le port d'activation MotorEnable √©crit un niveau bas, et le moteur s'arr√™te de tourner.

.. code-block:: js

    let index=-1
    setInterval(() => {
        index=(index+1)%3
        motor(index)
    }, 1000)    

Faire tourner le moteur alternativement dans le sens horaire et antihoraire, avec un intervalle de 1 seconde.

.. code-block:: js

    process.on('SIGINT', function () {
        MotorEnable.digitalWrite(0)
        process.exit();
    })

Lorsqu'il est d√©tect√© que **ctrl+c is** press√©,
MotorEnable √©crit un niveau bas pour arr√™ter le moteur de tourner.

Image du Ph√©nom√®ne
-------------------------

.. image:: ../img/image119.jpeg