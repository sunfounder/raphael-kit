.. note::

    Hallo und willkommen in der SunFounder Raspberry Pi & Arduino & ESP32 Enthusiasten-Gemeinschaft auf Facebook! Tauchen Sie tiefer ein in die Welt von Raspberry Pi, Arduino und ESP32 mit anderen Enthusiasten.

    **Warum beitreten?**

    - **Expertenunterst√ºtzung**: L√∂sen Sie Nachverkaufsprobleme und technische Herausforderungen mit Hilfe unserer Gemeinschaft und unseres Teams.
    - **Lernen & Teilen**: Tauschen Sie Tipps und Anleitungen aus, um Ihre F√§higkeiten zu verbessern.
    - **Exklusive Vorschauen**: Erhalten Sie fr√ºhzeitigen Zugang zu neuen Produktank√ºndigungen und exklusiven Einblicken.
    - **Spezialrabatte**: Genie√üen Sie exklusive Rabatte auf unsere neuesten Produkte.
    - **Festliche Aktionen und Gewinnspiele**: Nehmen Sie an Gewinnspielen und Feiertagsaktionen teil.

    üëâ Sind Sie bereit, mit uns zu erkunden und zu erschaffen? Klicken Sie auf [|link_sf_facebook|] und treten Sie heute bei!

.. _2.1.6_js:

2.1.6 Drehgeber Modul
=====================

Einf√ºhrung
----------

In diesem Projekt werden Sie den Drehgeber kennenlernen. Ein Drehgeber ist
ein elektronischer Schalter mit einer Reihe von regelm√§√üigen Impulsen in strengem 
Zeitablauf. In Verbindung mit einem IC k√∂nnen Sie Erh√∂hen, Verringern, Seitenumbruch 
und andere Vorg√§nge wie Maus-Scrolling, Men√ºauswahl usw. realisieren.

Ben√∂tigte Komponenten
---------------------

F√ºr dieses Projekt ben√∂tigen wir die folgenden Komponenten.

.. image:: ../img/Part_two_25.png

Es ist definitiv praktisch, ein ganzes Kit zu kaufen. Hier ist der Link:

.. list-table::
    :widths: 20 20 20
    :header-rows: 1

    *   - Name
        - ARTIKEL IN DIESEM KIT
        - LINK
    *   - Raphael Kit
        - 337
        - |link_Raphael_kit|

Sie k√∂nnen diese auch einzeln √ºber die untenstehenden Links kaufen.

.. list-table::
    :widths: 30 20
    :header-rows: 1

    *   - KOMPONENTENBESCHREIBUNG
        - KAUF-LINK

    *   - :ref:`cpn_gpio_board`
        - |link_gpio_board_buy|
    *   - :ref:`cpn_breadboard`
        - |link_breadboard_buy|
    *   - :ref:`cpn_wires`
        - |link_wires_buy|
    *   - :ref:`cpn_rotary_encoder`
        - |link_rotary_encoder_buy|

Schaltplan
----------

.. image:: ../img/image349.png
   :align: center

Experimentelle Verfahren
------------------------

**Schritt 1:** Bauen Sie den Schaltkreis.

.. image:: ../img/2.1.6_fritzing.png
   :align: center

In diesem Beispiel k√∂nnen wir den Drehgeber-Pin direkt an den 
Raspberry Pi anschlie√üen. Verwenden Sie dazu ein Breadboard und ein 40-Pin-Kabel. Verbinden Sie 
das GND des Drehgebers mit GND, „Äå+„Äçmit 5V, SW mit digitalem GPIO27, DT mit digitalem GPIO18 und CLK mit digitalem GPIO
17.

**Schritt 2:** Wechseln Sie in den Ordner des Codes.

.. raw:: html

   <run></run>

.. code-block::

    cd ~/raphael-kit/nodejs/

**Schritt 3:** F√ºhren Sie den Code aus.

.. raw:: html

   <run></run>

.. code-block::

    sudo node rotary_encoder_module.js

Sie werden die Z√§hlung in der Shell sehen. 
Wenn Sie den Drehgeber im Uhrzeigersinn drehen, erh√∂ht sich der Z√§hlerstand; 
drehen Sie ihn gegen den Uhrzeigersinn, verringert sich der Z√§hlerstand. 
Wenn Sie den Schalter am Drehgeber dr√ºcken, wird der Z√§hlerstand auf null zur√ºckgesetzt.


**Code**

.. code-block:: js

    const Gpio = require('pigpio').Gpio;

    const clkPin = new Gpio(17, {
      mode: Gpio.INPUT,
      pullUpDown: Gpio.PUD_DOWN,
      edge: Gpio.RISING_EDGE
    });
    const dtPin = new Gpio(18, {
      mode: Gpio.INPUT,
      pullUpDown: Gpio.PUD_DOWN,    
    });
    const swPin = new Gpio(27, {
      mode: Gpio.INPUT,
      pullUpDown: Gpio.PUD_UP,
      edge: Gpio.FALLING_EDGE
    });

    var globalCounter = 0;

    clkPin.on('interrupt',()=>{
      if(dtPin.digitalRead()==1){
          globalCounter--;
      }
      else{
          globalCounter++;
      }
      console.log(`globalCounter = ${globalCounter}`);
    });

    swPin.on('interrupt', () => {
      globalCounter = 0;
      console.log(`globalCounter = ${globalCounter}`);
    });




**Code Erkl√§rung**

.. code-block:: js

    var globalCounter = 0;

    clkPin.on('interrupt',()=>{
      if(dtPin.digitalRead()==1){
          globalCounter--;
      }
      else{
          globalCounter++;
      }
      console.log(`globalCounter = ${globalCounter}`);
    });

Wenn dtPin von niedrig auf hoch wechselt und clkPin hoch ist,
die Z√§hlung nimmt ab,
andernfalls erh√∂ht sich die Anzahl.


.. code-block:: js

    swPin.on('interrupt', () => {
      globalCounter = 0;
      console.log(`globalCounter = ${globalCounter}`);
    });


Der swPin gibt einen Low-Ausgang aus, wenn die Welle gedr√ºckt wird.
Lassen Sie den globalCounter an dieser Stelle auf Null gehen

Ph√§nomen-Bild
--------------------

.. image:: ../img/2.1.6rotary_ecoder.JPG
   :align: center
   
