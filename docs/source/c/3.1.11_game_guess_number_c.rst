.. note::

    Hallo und willkommen in der SunFounder Raspberry Pi & Arduino & ESP32 Enthusiasten-Gemeinschaft auf Facebook! Tauchen Sie tiefer ein in die Welt von Raspberry Pi, Arduino und ESP32 mit anderen Enthusiasten.

    **Warum beitreten?**

    - **ExpertenunterstÃ¼tzung**: LÃ¶sen Sie Nachverkaufsprobleme und technische Herausforderungen mit Hilfe unserer Gemeinschaft und unseres Teams.
    - **Lernen & Teilen**: Tauschen Sie Tipps und Anleitungen aus, um Ihre FÃ¤higkeiten zu verbessern.
    - **Exklusive Vorschauen**: Erhalten Sie frÃ¼hzeitigen Zugang zu neuen ProduktankÃ¼ndigungen und exklusiven Einblicken.
    - **Spezialrabatte**: GenieÃŸen Sie exklusive Rabatte auf unsere neuesten Produkte.
    - **Festliche Aktionen und Gewinnspiele**: Nehmen Sie an Gewinnspielen und Feiertagsaktionen teil.

    ðŸ‘‰ Sind Sie bereit, mit uns zu erkunden und zu erschaffen? Klicken Sie auf [|link_sf_facebook|] und treten Sie heute bei!

.. _3.1.11_c:

3.1.11 SPIEL â€“ Zahlen raten
=======================================

EinfÃ¼hrung
------------------

"Zahlen raten" ist ein lustiges Partyspiel, bei dem du und deine Freunde abwechselnd eine Zahl (0~99) eingeben. Mit jeder eingegebenen Zahl wird der Bereich kleiner, bis ein Spieler das RÃ¤tsel richtig lÃ¶st. Dann wird der Spieler besiegt und bestraft. Zum Beispiel, wenn die GlÃ¼ckszahl 51 ist, die die Spieler nicht sehen kÃ¶nnen, und Spieler â‘  gibt 50 ein, dann Ã¤ndert sich die Zahlenbereichsanzeige zu 50~99; wenn Spieler â‘¡ 70 eingibt, kann der Zahlenbereich 50~70 sein; wenn Spieler â‘¢ 51 eingibt, ist dieser Spieler der Pechvogel. Hier verwenden wir ein Tastenfeld zur Eingabe von Zahlen und ein LCD zur Ausgabe von Ergebnissen.

BenÃ¶tigte Komponenten
------------------------------

FÃ¼r dieses Projekt benÃ¶tigen wir die folgenden Komponenten.

.. image:: ../img/list_GAME_Guess_Number.png
    :align: center

Es ist definitiv praktisch, ein ganzes Kit zu kaufen, hier ist der Link:

.. list-table::
    :widths: 20 20 20
    :header-rows: 1

    *   - Name	
        - ARTIKEL IN DIESEM KIT
        - LINK
    *   - Raphael Kit
        - 337
        - |link_Raphael_kit|

Sie kÃ¶nnen diese auch separat Ã¼ber die untenstehenden Links kaufen.

.. list-table::
    :widths: 30 20
    :header-rows: 1

    *   - KOMPONENTENBESCHREIBUNG
        - KAUF-LINK

    *   - :ref:`cpn_gpio_board`
        - |link_gpio_board_buy|
    *   - :ref:`cpn_breadboard`
        - |link_breadboard_buy|
    *   - :ref:`cpn_wires`
        - |link_wires_buy|
    *   - :ref:`cpn_resistor`
        - |link_resistor_buy|
    *   - :ref:`cpn_keypad`
        - \-
    *   - :ref:`cpn_i2c_lcd1602`
        - |link_i2clcd1602_buy|

Schaltplan
-----------------------

============ ======== ======== =======
T-Board Name physical wiringPi BCM
GPIO18       Pin 12   1        18
GPIO23       Pin 16   4        23
GPIO24       Pin 18   5        24
GPIO25       Pin 22   6        25
SPIMOSI      Pin 19   12       10
GPIO22       Pin 15   3        22
GPIO27       Pin 13   2        27
GPIO17       Pin 11   0        17
SDA1         Pin 3    SDA1(8)  SDA1(2)
SCL1         Pin 5    SCL1(9)  SDA1(3)
============ ======== ======== =======

.. image:: ../img/Schematic_three_one12.png
   :align: center

Experimentelle Verfahren
-----------------------------

**Schritt 1:** Schalte den Stromkreis.

.. image:: ../img/image273.png

**Schritt 2**: I2C einrichten (siehe Anhang :ref:`i2c_config`. Wenn Sie I2C bereits eingerichtet haben, Ã¼berspringen Sie diesen Schritt.)

**Schritt 3**: Verzeichnis wechseln.

.. raw:: html

   <run></run>

.. code-block:: 

    cd ~/raphael-kit/c/3.1.11/

**Schritt 4**: Kompilieren.

.. raw:: html

   <run></run>

.. code-block:: 

    gcc 3.1.11_GAME_GuessNumber.c -lwiringPi

**Schritt 5**: AusfÃ¼hren.

.. raw:: html

   <run></run>

.. code-block:: 

    sudo ./a.out

Nachdem das Programm gestartet wurde, wird die Startseite auf dem LCD angezeigt:

.. note::

    * Wenn ein Fehlerhinweis ``wiringPi.h: No such file or directory`` erscheint, bitte beziehen Sie sich auf :ref:`install_wiringpi`.
    * Wenn Sie den Fehler ``Unable to open I2C device: No such file or directory`` erhalten, mÃ¼ssen Sie :ref:`i2c_config` konsultieren, um I2C zu aktivieren und zu Ã¼berprÃ¼fen, ob die Verkabelung korrekt ist.
    * Wenn der Code und die Verkabelung in Ordnung sind, das LCD jedoch immer noch keinen Inhalt anzeigt, kÃ¶nnen Sie das Potentiometer auf der RÃ¼ckseite drehen, um den Kontrast zu erhÃ¶hen.

.. code-block:: 

   Willkommen!
   DrÃ¼cken SieÂ AÂ zum Starten!

DrÃ¼cken Sie "A", und das Spiel beginnt, und die Spielseite wird auf dem LCD angezeigt.

.. code-block:: 

   Nummer eingeben:
   0 â€¹Punktâ€¹ 99

Eine zufÃ¤llige Zahl '\ **point**\ ' wird erzeugt, aber beim Spielstart nicht auf dem LCD angezeigt, und Ihre Aufgabe ist es, diese zu erraten. Die von Ihnen eingegebene Zahl erscheint am Ende der ersten Zeile, bis die endgÃ¼ltige Berechnung abgeschlossen ist. (DrÃ¼cken Sie "D", um den Vergleich zu starten. Wenn die eingegebene Zahl grÃ¶ÃŸer als **10** ist, beginnt der automatische Vergleich.)

Der Zahlenbereich von "Punkt" wird in der zweiten Zeile angezeigt. Und Sie mÃ¼ssen eine Zahl innerhalb dieses Bereichs eingeben. Wenn Sie eine Zahl eingeben, wird der Bereich enger; wenn Sie zufÃ¤llig oder unglÃ¼cklicherweise die GlÃ¼ckszahl bekommen, wird die Meldung "Du hast es geschafft!" angezeigt.

**Code-ErklÃ¤rung**

Zu Beginn des Codes befinden sich die funktionalen Funktionen von **keypad** und **I2C LCD1602**. Mehr Details Ã¼ber sie kÃ¶nnen Sie in :ref:`1.1.7_c` und :ref:`2.1.8_c` nachlesen.

Hier, was wir wissen mÃ¼ssen, ist folgendes:

.. code-block:: c

    /****************************************/
    //StartÂ fromÂ here
    /****************************************/
    voidÂ init(void){
    Â Â Â Â fdÂ =Â wiringPiI2CSetup(LCDAddr);
    Â Â Â Â lcd_init();
    Â Â Â Â lcd_clear();
    Â Â Â Â for(intÂ i=0Â ;Â i<4Â ;Â i++)Â {
    Â Â Â Â Â Â Â Â pinMode(rowPins[i],Â OUTPUT);
    Â Â Â Â Â Â Â Â pinMode(colPins[i],Â INPUT);
    Â Â Â Â }
    Â Â Â Â lcd_clear();
    Â Â Â Â write(0,Â 0,Â "Welcome!");
    Â Â Â Â write(0,Â 1,Â "PressÂ AÂ toÂ go!");
    }
    
Diese Funktion dient dazu, **I2C LCD1602** und **Keypad** initial zu definieren und â€žWillkommen!â€œ sowie â€žDrÃ¼ckenÂ SieÂ AÂ umÂ fortzufahren!â€œ anzuzeigen.

.. code-block:: c

    voidÂ init_new_value(void){
    Â Â Â Â srand(time(0));
    Â Â Â Â pointValueÂ =Â rand()%100;
    Â Â Â Â upperÂ =Â 99;
    Â Â Â Â lowerÂ =Â 0;
    Â Â Â Â countÂ =Â 0;
    Â Â Â Â printf("pointÂ isÂ %d\n",pointValue);
    }

Die Funktion erzeugt die Zufallszahl '\ **point**\ ' und setzt den Bereichshinweis fÃ¼r den Punkt zurÃ¼ck.

.. code-block:: c

    boolÂ detect_point(void){
    Â Â Â Â if(countÂ >Â pointValue){
    Â Â Â Â Â Â Â Â if(countÂ <Â upper){
    Â Â Â Â Â Â Â Â Â Â Â Â upperÂ =Â count;
    Â Â Â Â Â Â Â Â }
    Â Â Â Â }
    Â Â Â Â elseÂ if(countÂ <Â pointValue){
    Â Â Â Â Â Â Â Â if(countÂ >Â lower){
    Â Â Â Â Â Â Â Â Â Â Â Â lowerÂ =Â count;
    Â Â Â Â Â Â Â Â }
    Â Â Â Â }
    Â Â Â Â elseÂ if(countÂ =Â pointValue){
    Â Â Â Â Â Â Â Â countÂ =Â 0;
    Â Â Â Â Â Â Â Â returnÂ 1;
    Â Â Â Â }
    Â Â Â Â countÂ =Â 0;
    Â Â Â Â returnÂ 0;
    }

detect_point() vergleicht die eingegebene Nummer mit dem erzeugten â€žPunktâ€œ. Wenn das Vergleichsergebnis zeigt, dass sie nicht gleich sind, wird **count** Werte **upper** und **lower** zuweisen und '\ **0**\ ' zurÃ¼ckgeben; ansonsten, wenn sie gleich sind, gibt sie '\ **1**\ ' zurÃ¼ck.

.. code-block:: c

    voidÂ lcd_show_input(boolÂ result){
    Â Â Â Â charÂ *str=NULL;
    Â Â Â Â strÂ =(char*)malloc(sizeof(char)*3);
    Â Â Â Â lcd_clear();
    Â Â Â Â ifÂ (resultÂ ==Â 1){
    Â Â Â Â Â Â Â Â write(0,1,"You'veÂ gotÂ it!");
    Â Â Â Â Â Â Â Â delay(5000);
    Â Â Â Â Â Â Â Â init_new_value();
    Â Â Â Â Â Â Â Â lcd_show_input(0);
    Â Â Â Â Â Â Â Â return;
    Â Â Â Â }
    Â Â Â Â write(0,0,"EnterÂ number:");
    Â Â Â Â Int2Str(str,count);
    Â Â Â Â write(13,0,str);
    Â Â Â Â Int2Str(str,lower);
    Â Â Â Â write(0,1,str);
    Â Â Â Â write(3,1,"<Point<");
    Â Â Â Â Int2Str(str,upper);
    Â Â Â Â write(12,1,str);
    }

Diese Funktion dient zur Anzeige der Spielseite. Beachten Sie die Funktion **Int2Str(str,count)**, sie konvertiert diese Variablen **count**, **lower** und **upper** von **Integer** zu **character string** fÃ¼r die korrekte Anzeige des **lcd**.

.. code-block:: c

    intÂ main(){
    Â Â Â Â unsignedÂ charÂ pressed_keys[BUTTON_NUM];
    Â Â Â Â unsignedÂ charÂ last_key_pressed[BUTTON_NUM];
    Â Â Â Â if(wiringPiSetup()Â ==Â -1){Â //whenÂ initializeÂ wiringÂ failed,printÂ messagetoÂ screen
    Â Â Â Â Â Â Â Â printf("setupÂ wiringPiÂ failedÂ !");
    Â Â Â Â Â Â Â Â returnÂ 1;Â 
    Â Â Â Â }
    Â Â Â Â init();
    Â Â Â Â init_new_value();
    Â Â Â Â while(1){
    Â Â Â Â Â Â Â Â keyRead(pressed_keys);
    Â Â Â Â Â Â Â Â boolÂ compÂ =Â keyCompare(pressed_keys,Â last_key_pressed);
    Â Â Â Â Â Â Â Â ifÂ (!comp){
    Â Â Â Â Â Â Â Â Â Â Â Â if(pressed_keys[0]Â !=Â 0){
    Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â boolÂ resultÂ =Â 0;
    Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â if(pressed_keys[0]Â ==Â 'A'){
    Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â init_new_value();
    Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â lcd_show_input(0);
    Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }
    Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â elseÂ if(pressed_keys[0]Â ==Â 'D'){
    Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â resultÂ =Â detect_point();
    Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â lcd_show_input(result);
    Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }
    Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â elseÂ if(pressed_keys[0]Â >='0'Â &&Â pressed_keys[0]Â <=Â '9'){
    Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â countÂ =Â countÂ *Â 10;
    Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â countÂ =Â countÂ +Â (pressed_keys[0]Â -Â 48);
    Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (count>=10){
    Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â resultÂ =Â detect_point();
    Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }
    Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â lcd_show_input(result);
    Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â }
    Â Â Â Â Â Â Â Â Â Â Â Â }
    Â Â Â Â Â Â Â Â Â Â Â Â keyCopy(last_key_pressed,Â pressed_keys);
    Â Â Â Â Â Â Â Â }
    Â Â Â Â Â Â Â Â delay(100);
    Â Â Â Â }
    Â Â Â Â returnÂ 0;Â Â Â 
    }


Main() enthÃ¤lt den gesamten Prozess des Programms, wie unten dargestellt:

1) Initialisierung von **I2C LCD1602** und **Keypad**.

2) Verwenden von **init_new_value()**, um eine Zufallszahl **0-99** zu erstellen.

3) PrÃ¼fen, ob die Taste gedrÃ¼ckt wurde und den Tastenwert abrufen.

4) Wenn die Taste '\ **A**\ ' gedrÃ¼ckt wird, erscheint eine Zufallszahl **0-99** und das Spiel beginnt.

5) Wenn festgestellt wird, dass die Taste '\ **D**\ ' gedrÃ¼ckt wurde, tritt das Programm in die Ergebnisbewertung ein und zeigt das Ergebnis auf dem LCD an. Dieser Schritt gewÃ¤hrleistet, dass Sie das Ergebnis auch dann beurteilen kÃ¶nnen, wenn Sie nur eine Nummer drÃ¼cken und anschlieÃŸend die Taste '\ **D**\ ' betÃ¤tigen.

6) Wenn eine Taste **0-9** gedrÃ¼ckt wird, Ã¤ndert sich der Wert von **count**; wenn **count** grÃ¶ÃŸer als **10** ist, beginnt die Beurteilung.

7) Die Ã„nderungen des Spiels und seiner Werte werden auf **LCD1602** angezeigt.

PhÃ¤nomen-Bild
------------------------

.. image:: ../img/image274.jpeg
   :align: center