.. note::

    춰Hola! Bienvenido a la Comunidad de Entusiastas de SunFounder Raspberry Pi & Arduino & ESP32 en Facebook. Profundiza en Raspberry Pi, Arduino y ESP32 con otros entusiastas.

    **쯇or qu칠 unirse?**

    - **Soporte experto**: Resuelve problemas postventa y desaf칤os t칠cnicos con la ayuda de nuestra comunidad y equipo.
    - **Aprende y comparte**: Intercambia consejos y tutoriales para mejorar tus habilidades.
    - **Vistas previas exclusivas**: Accede anticipadamente a anuncios de nuevos productos y adelantos exclusivos.
    - **Descuentos especiales**: Disfruta de descuentos exclusivos en nuestros productos m치s nuevos.
    - **Promociones festivas y sorteos**: Participa en sorteos y promociones de temporada.

    游녤 쯃isto para explorar y crear con nosotros? Haz clic en [|link_sf_facebook|] y 칰nete hoy mismo.

.. _2.2.5_c:

2.2.5 M칩dulo de Evitaci칩n de Obst치culos IR
=============================================

Introducci칩n
---------------

En este proyecto, aprenderemos sobre el m칩dulo de evitaci칩n de obst치culos IR, que es un m칩dulo sensor que se puede usar para detectar obst치culos a cortas distancias, con poca interferencia, f치cil de ensamblar, f치cil de usar, etc. Se puede usar ampliamente en robots de evitaci칩n de obst치culos, carritos de evitaci칩n de obst치culos, conteo en l칤neas de ensamblaje, etc.


Componentes Necesarios
-------------------------

En este proyecto, necesitaremos los siguientes componentes.

.. image:: ../img/2.2.5component.png
   :width: 700
   :align: center

Es definitivamente conveniente comprar un kit completo, aqu칤 est치 el enlace:

.. list-table::
    :widths: 20 20 20
    :header-rows: 1

    *   - Nombre	
        - ART칈CULOS EN ESTE KIT
        - ENLACE
    *   - Kit Raphael
        - 337
        - |link_Raphael_kit|

Tambi칠n puedes comprarlos por separado en los enlaces a continuaci칩n.

.. list-table::
    :widths: 30 20
    :header-rows: 1

    *   - INTRODUCCI칍N AL COMPONENTE
        - ENLACE DE COMPRA

    *   - :ref:`cpn_gpio_board`
        - |link_gpio_board_buy|
    *   - :ref:`cpn_breadboard`
        - |link_breadboard_buy|
    *   - :ref:`cpn_wires`
        - |link_wires_buy|
    *   - :ref:`cpn_avoid_module`
        - |link_obstacle_avoidance_buy|

Diagrama Esquem치tico
------------------------

.. image:: ../img/IR_schematic.png
   :width: 500
   :align: center

Procedimientos Experimentales
---------------------------------

**Paso 1:** Construir el circuito.

.. image:: ../img/2.2.5fritzing.png
   :width: 700
   :align: center

**Paso 2:** Cambiar directorio.

.. raw:: html

   <run></run>

.. code-block::
   
   cd ~/raphael-kit/c/2.2.5/

**Paso 3:** Compilar.

.. raw:: html

   <run></run>

.. code-block::

   gcc 2.2.5_IrObstacle.c -lwiringPi

**Paso 4:** Ejecutar.

.. raw:: html

   <run></run>

.. code-block::

   sudo ./a.out

Despu칠s de ejecutar el c칩digo, cuando pongas tu mano frente a la sonda del m칩dulo, 
el indicador de salida en el m칩dulo se encender치 y "Detected Barrier!" se imprimir치 
repetidamente en la pantalla.

.. note::

   Si no funciona despu칠s de ejecutarlo, o hay un mensaje de error: \"wiringPi.h: No such file or directory\", por favor consulta :ref:`install_wiringpi`.


**C칩digo**

.. code-block:: c

   #include <wiringPi.h>
   #include <stdio.h>

   #define ObstaclePin      0

   void myISR(void)
   {
      printf("Detected Barrier !\n");
   }

   int main(void)
   {
      if(wiringPiSetup() == -1){ //when initialize wiring failed,print messageto screen
         printf("setup wiringPi failed !\n");
         return 1; 
      }
      
      if(wiringPiISR(ObstaclePin, INT_EDGE_FALLING, &myISR) < 0){
         printf("Unable to setup ISR !!!\n");
         return 1;
      }
      
      while(1){
         ;
      }

      return 0;
   }

**Explicaci칩n del C칩digo**

.. code-block:: c

   void myISR(void)
   {
      printf("Detected Barrier !\n");
   }

Define una funci칩n ``myISR()`` para imprimir ``Detected Barrier !``, indicando que se ha detectado un obst치culo.

.. code-block:: c

   if(wiringPiISR(ObstaclePin, INT_EDGE_FALLING, &myISR) < 0){
      printf("Unable to setup ISR !!!\n");
      return 1;
   }

Esta funci칩n ``wiringPiISR()`` registra una funci칩n ``myISR()`` para recibir interrupciones en el ``ObstaclePin`` especificado.

Cuando el ObstaclePin cambia de alto a bajo, significa que se ha detectado un obst치culo. En ese momento, llama a la funci칩n ``myISR()`` para imprimir "Detected Barrier !".

El prototipo de esta funci칩n ``wiringPiISR()`` se muestra a continuaci칩n.

.. code-block:: c

   int wiringPiISR (int pin, int edgeType,  void (*function)(void)) ;

El par치metro edgeType es ``INT_EDGE_FALLING``, ``INT_EDGE_RISING``, ``INT_EDGE_BOTH`` o ``INT_EDGE_SETUP``. Si es ``INT_EDGE_SETUP``, no se realizar치 la inicializaci칩n del pin; se asume que ya has configurado el pin en otro lugar (por ejemplo, con el programa gpio), pero si especificas uno de los otros tipos, entonces el pin se exportar치 y se inicializar치 seg칰n lo especificado.

Para m치s informaci칩n, consulta: `wiringPi-Functions (API) <https://projects.drogon.net/raspberry-pi/wiringpi/functions/>`_.

Imagen del Fen칩meno
-----------------------

.. image:: ../img/2.2.5IR.JPG
   :width: 500
   :align: center