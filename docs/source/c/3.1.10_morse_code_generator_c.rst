.. note::

    Â¡Hola! Bienvenido a la Comunidad de Entusiastas de SunFounder Raspberry Pi & Arduino & ESP32 en Facebook. SumÃ©rgete mÃ¡s en Raspberry Pi, Arduino y ESP32 con otros entusiastas.

    **Â¿Por quÃ© unirte?**

    - **Soporte experto**: Resuelve problemas postventa y desafÃ­os tÃ©cnicos con la ayuda de nuestra comunidad y equipo.
    - **Aprende y comparte**: Intercambia consejos y tutoriales para mejorar tus habilidades.
    - **Avances exclusivos**: ObtÃ©n acceso anticipado a nuevos anuncios de productos y vistas previas.
    - **Descuentos especiales**: Disfruta de descuentos exclusivos en nuestros productos mÃ¡s nuevos.
    - **Promociones y sorteos festivos**: Participa en sorteos y promociones de temporada.

    ğŸ‘‰ Â¿Listo para explorar y crear con nosotros? Haz clic en [|link_sf_facebook|] y Ãºnete hoy mismo!

.. _3.1.10_c:

3.1.10 Generador de CÃ³digo Morse
===================================

IntroducciÃ³n
-----------------

En este proyecto, crearemos un generador de cÃ³digo Morse, donde escribirÃ¡s una 
serie de letras en inglÃ©s en la Raspberry Pi para que aparezca como cÃ³digo Morse.

Componentes necesarios
------------------------------

En este proyecto, necesitamos los siguientes componentes.

.. image:: ../img/3.1.10.png
    :align: center

Es definitivamente conveniente comprar un kit completo, aquÃ­ estÃ¡ el enlace:

.. list-table::
    :widths: 20 20 20
    :header-rows: 1

    *   - Nombre	
        - COMPONENTES EN ESTE KIT
        - ENLACE
    *   - Kit Raphael
        - 337
        - |link_Raphael_kit|

TambiÃ©n puedes comprarlos por separado en los enlaces a continuaciÃ³n.

.. list-table::
    :widths: 30 20
    :header-rows: 1

    *   - INTRODUCCIÃ“N DEL COMPONENTE
        - ENLACE DE COMPRA

    *   - :ref:`cpn_gpio_extension_board`
        - |link_gpio_board_buy|
    *   - :ref:`cpn_breadboard`
        - |link_breadboard_buy|
    *   - :ref:`cpn_wires`
        - |link_wires_buy|
    *   - :ref:`cpn_resistor`
        - |link_resistor_buy|
    *   - :ref:`cpn_led`
        - |link_led_buy|
    *   - :ref:`cpn_buzzer`
        - \-
    *   - :ref:`cpn_transistor`
        - |link_transistor_buy|

Diagrama EsquemÃ¡tico
---------------------------

============== ========== ======== ===
Nombre T-Board Pin fÃ­sico wiringPi BCM
GPIO17         Pin 11     0        17
GPIO22         Pin 15     3        22
============== ========== ======== ===

.. image:: ../img/Schematic_three_one11.png
   :align: center

Procedimientos Experimentales
-----------------------------------

**Paso 1:** Construir el circuito. (Presta atenciÃ³n a los polos del zumbador: el que 
tiene la etiqueta + es el polo positivo y el otro es el negativo).

.. image:: ../img/image269.png

**Paso 2**: Abre el archivo de cÃ³digo.

.. raw:: html

   <run></run>

.. code-block:: 

    cd ~/raphael-kit/c/3.1.10/

**Paso 3**: Compila el cÃ³digo.

.. raw:: html

   <run></run>

.. code-block:: 

    gcc 3.1.10_MorseCodeGenerator.c -lwiringPi

**Paso 4**: Ejecuta el archivo ejecutable anterior.

.. raw:: html

   <run></run>

.. code-block:: 

    sudo ./a.out

DespuÃ©s de que el programa se ejecute, escribe una serie de caracteres y 
el zumbador y el LED enviarÃ¡n las seÃ±ales de cÃ³digo Morse correspondientes.

.. note::

    Si no funciona despuÃ©s de ejecutarlo, o aparece un mensaje de error: \"wiringPi.h: No such file or directory\", consulta :ref:`install_wiringpi`.

**ExplicaciÃ³n del CÃ³digo**

.. code-block:: c

    structÂ MORSE{
    Â Â Â Â charÂ word;
    Â Â Â Â unsignedÂ charÂ *code;
    };

    structÂ MORSEÂ morseDict[]=
    {
    Â Â Â Â {'A',"01"},Â {'B',"1000"},Â {'C',"1010"},Â {'D',"100"},Â {'E',"0"},Â 
    Â Â Â Â {'F',"0010"},Â {'G',"110"},Â {'H',"0000"},Â {'I',"00"},Â {'J',"0111"},Â 
    Â Â Â Â {'K',"101"},Â {'L',"0100"},Â {'M',"11"},Â {'N',"10"},Â {'O',"111"},Â 
    Â Â Â Â {'P',"0110"},Â {'Q',"1101"},Â {'R',"010"},Â {'S',"000"},Â {'T',"1"},
    Â Â Â Â {'U',"001"},Â {'V',"0001"},Â {'W',"011"},Â {'X',"1001"},Â {'Y',"1011"},Â 
    Â Â Â Â {'Z',"1100"},{'1',"01111"},Â {'2',"00111"},Â {'3',"00011"},Â {'4',"00001"},Â 
    Â Â Â Â {'5',"00000"},{'6',"10000"},Â {'7',"11000"},Â {'8',"11100"},Â {'9',"11110"},
    Â Â Â Â {'0',"11111"},{'?',"001100"},Â {'/',"10010"},Â {',',"110011"},Â {'.',"010101"},
    Â Â Â Â {';',"101010"},{'!',"101011"},Â {'@',"011010"},Â {':',"111000"}
    };

Esta estructura MORSE es el diccionario del cÃ³digo Morse, que contiene los caracteres 
A-Z, nÃºmeros 0-9 y sÃ­mbolos â€œ?â€ â€œ/â€ â€œ:â€ â€œ,â€ â€œ.â€ â€œ;â€ â€œ!â€ â€œ@â€.

.. code-block:: c

    charÂ *lookup(charÂ key,structÂ MORSEÂ *dict,intÂ length)
    {
    Â Â Â Â forÂ (intÂ i=0;i<length;i++)
        {
    Â Â Â Â Â Â Â Â if(dict[i].word==key){
    Â Â Â Â Â Â Â Â Â Â Â Â returnÂ dict[i].code;
            }
        }    
    }

La funciÃ³n  ``lookup()`` funciona â€œconsultando el diccionarioâ€. Define una ``key`` que 
busca las palabras iguales a ``key`` en la estructura ``morseDict`` y devuelve la informaciÃ³n 
correspondiente â€” ``code`` de la palabra determinada.

.. code-block:: c

    voidÂ on(){
    Â Â Â Â digitalWrite(ALedPin,HIGH);
    Â Â Â Â digitalWrite(BeepPin,HIGH);Â Â Â Â Â 
    }

Crea una funciÃ³n ``on()`` para activar el zumbador y el LED.

.. code-block:: c

    voidÂ off(){
    Â Â Â Â digitalWrite(ALedPin,LOW);
    Â Â Â Â digitalWrite(BeepPin,LOW);
    }

La funciÃ³n ``off()`` apaga el zumbador y el LED.

.. code-block:: c

    voidÂ beep(intÂ dt){
        on();
        delay(dt);
        off();
        delay(dt);
    }

Define una funciÃ³n ``beep()`` para que el zumbador y el LED emitan sonidos y parpadeen 
en un intervalo determinado de **dt**.

.. code-block:: c

    voidÂ morsecode(charÂ *code){
    Â Â Â Â intÂ pauseÂ =Â 250;
    Â Â Â Â charÂ *pointÂ =Â NULL;
    Â Â Â Â intÂ lengthÂ =Â sizeof(morseDict)/sizeof(morseDict[0]);
    Â Â Â Â forÂ (intÂ i=0;i<strlen(code);i++)
        {
    Â Â Â Â Â Â Â Â point=lookup(code[i],morseDict,length);
    Â Â Â Â Â Â Â Â forÂ (intÂ j=0;j<strlen(point);j++){
    Â Â Â Â Â Â Â Â Â Â Â Â ifÂ (point[j]=='0')
                {
    Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â Â beep(pause/2);
    Â Â Â Â Â Â Â Â Â Â Â Â }elseÂ if(point[j]=='1')
                {
                    beep(pause);
                }
                delay(pause);
            }
        }
    }

La funciÃ³n `morsecode()` se utiliza para procesar el cÃ³digo Morse de los 
caracteres de entrada haciendo que el â€œ1â€ del cÃ³digo mantenga la emisiÃ³n de 
sonidos o luces y el â€œ0â€ emita brevemente sonidos o luces, por ejemplo, si se 
ingresa â€œSOSâ€, habrÃ¡ una seÃ±al que contiene tres segmentos cortos, tres largos 
y luego tres cortos â€œ Â· Â· Â· - - - Â· Â· Â· â€.

.. code-block:: c

    intÂ toupper(intÂ c)
    {
    Â Â Â Â ifÂ ((cÂ >=Â 'a')Â &&Â (cÂ <=Â 'z'))
    Â Â Â Â Â Â Â Â returnÂ cÂ +Â ('A'Â -Â 'a');
    Â Â Â Â returnÂ c;
    }
    charÂ *strupr(charÂ *str)
    {
    Â Â Â Â charÂ *orign=str;
    Â Â Â Â forÂ (;Â *str!='\0';Â str++)
    Â Â Â Â Â Â Â Â *strÂ =Â toupper(*str);
    returnÂ orign;
    }

Antes de codificar, necesitas unificar las letras en mayÃºsculas.

.. code-block:: c

    voidÂ main(){
        setup();
    Â Â Â Â charÂ *code;
    Â Â Â Â intÂ length=8;
    Â Â Â Â codeÂ =Â (char*)malloc(sizeof(char)*length);
    Â Â Â Â whileÂ (1){
    Â Â Â Â Â Â Â Â printf("PleaseÂ inputÂ theÂ messenger:");
    Â Â Â Â Â Â Â Â scanf("%s",code);
    Â Â Â Â Â Â Â Â code=strupr(code);
    Â Â Â Â Â Â Â Â printf("%s\n",code);
            morsecode(code);
        }
    }

Cuando escribes los caracteres relevantes con el teclado, ``code=strupr(code)`` convertirÃ¡ las letras ingresadas en su forma mayÃºscula.

``Printf()``  luego imprime el texto claro en la pantalla de la computadora, y la funciÃ³n ``morsecod()`` hace que el zumbador y el LED emitan el cÃ³digo Morse.

Ten en cuenta que la longitud del carÃ¡cter de entrada no debe exceder el **length** (se puede revisar).

Foto del FenÃ³meno
-----------------------

.. image:: ../img/image270.jpeg
   :align: center