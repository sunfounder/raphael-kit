.. note::

    ã“ã‚“ã«ã¡ã¯ã€SunFounderã®Raspberry Pi & Arduino & ESP32æ„›å¥½å®¶ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã¸ã‚ˆã†ã“ãï¼Facebookä¸Šã§Raspberry Piã€Arduinoã€ESP32ã«ã¤ã„ã¦ã‚‚ã£ã¨æ·±ãæ˜ã‚Šä¸‹ã’ã€ä»–ã®æ„›å¥½å®¶ã¨äº¤æµã—ã¾ã—ã‚‡ã†ã€‚

    **å‚åŠ ã™ã‚‹ç†ç”±ã¯ï¼Ÿ**

    - **ã‚¨ã‚­ã‚¹ãƒ‘ãƒ¼ãƒˆã‚µãƒãƒ¼ãƒˆ**ï¼šã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã‚„ãƒãƒ¼ãƒ ã®åŠ©ã‘ã‚’å€Ÿã‚Šã¦ã€è²©å£²å¾Œã®å•é¡Œã‚„æŠ€è¡“çš„ãªèª²é¡Œã‚’è§£æ±ºã—ã¾ã™ã€‚
    - **å­¦ã³ï¼†å…±æœ‰**ï¼šãƒ’ãƒ³ãƒˆã‚„ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã‚’äº¤æ›ã—ã¦ã‚¹ã‚­ãƒ«ã‚’å‘ä¸Šã•ã›ã¾ã—ã‚‡ã†ã€‚
    - **ç‹¬å çš„ãªãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼**ï¼šæ–°è£½å“ã®ç™ºè¡¨ã‚„å…ˆè¡Œãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã«æ—©æœŸã‚¢ã‚¯ã‚»ã‚¹ã—ã¾ã—ã‚‡ã†ã€‚
    - **ç‰¹åˆ¥å‰²å¼•**ï¼šæœ€æ–°è£½å“ã®ç‹¬å å‰²å¼•ã‚’ãŠæ¥½ã—ã¿ãã ã•ã„ã€‚
    - **ç¥­ã‚Šã®ãƒ—ãƒ­ãƒ¢ãƒ¼ã‚·ãƒ§ãƒ³ã¨ã‚®ãƒ•ãƒˆ**ï¼šã‚®ãƒ•ãƒˆã‚„ç¥æ—¥ã®ãƒ—ãƒ­ãƒ¢ãƒ¼ã‚·ãƒ§ãƒ³ã«å‚åŠ ã—ã¾ã—ã‚‡ã†ã€‚

    ğŸ‘‰ ç§ãŸã¡ã¨ä¸€ç·’ã«æ¢ç´¢ã—ã€å‰µé€ ã™ã‚‹æº–å‚™ã¯ã§ãã¦ã„ã¾ã™ã‹ï¼Ÿ[|link_sf_facebook|]ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ä»Šã™ãå‚åŠ ã—ã¾ã—ã‚‡ã†ï¼

.. _2.2.2_py_pi5:

2.2.2 ã‚µãƒ¼ãƒŸã‚¹ã‚¿
================

ã¯ã˜ã‚ã«
------------

ãƒ•ã‚©ãƒˆãƒ¬ã‚¸ã‚¹ã‚¿ãŒå…‰ã‚’æ„ŸçŸ¥ã™ã‚‹ã‚ˆã†ã«ã€ã‚µãƒ¼ãƒŸã‚¹ã‚¿ã¯æ¸©åº¦ã«æ„Ÿå¿œã™ã‚‹é›»å­ãƒ‡ãƒã‚¤ã‚¹ã§ã€æ¸©åº¦åˆ¶å¾¡ãªã©ã®æ©Ÿèƒ½ã‚’å®Ÿç¾ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã§ãã¾ã™ã€‚ãŸã¨ãˆã°ã€ãƒ’ãƒ¼ãƒˆã‚¢ãƒ©ãƒ¼ãƒ ã‚’ä½œæˆã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

å¿…è¦ãªéƒ¨å“
------------------------------

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ã¯ã€æ¬¡ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒå¿…è¦ã§ã™ã€‚ 

.. image:: ../python_pi5/img/2.2.2_thermistor_list.png

ä¸€å¼ã‚’è³¼å…¥ã™ã‚‹ã®ãŒä¾¿åˆ©ã§ã™ã€ã“ã¡ã‚‰ãŒãƒªãƒ³ã‚¯ã§ã™ï¼š 

.. list-table::
    :widths: 20 20 20
    :header-rows: 1

    *   - åå‰	
        - ã“ã®ã‚­ãƒƒãƒˆã®ã‚¢ã‚¤ãƒ†ãƒ 
        - ãƒªãƒ³ã‚¯
    *   - Raphael Kit
        - 337
        - |link_Raphael_kit|

ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯ã‹ã‚‰åˆ¥ã€…ã«è³¼å…¥ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

.. list-table::
    :widths: 30 20
    :header-rows: 1

    *   - ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ç´¹ä»‹
        - è³¼å…¥ãƒªãƒ³ã‚¯

    *   - :ref:`cpn_gpio_board`
        - |link_gpio_board_buy|
    *   - :ref:`cpn_breadboard`
        - |link_breadboard_buy|
    *   - :ref:`cpn_wires`
        - |link_wires_buy|
    *   - :ref:`cpn_resistor`
        - |link_resistor_buy|
    *   - :ref:`cpn_thermistor`
        - |link_thermistor_buy|
    *   - :ref:`cpn_adc0834`
        - \-


å›è·¯å›³
-----------------

.. image:: ../python_pi5/img/2.2.2_thermistor_schematic_1.png


.. image:: ../python_pi5/img/2.2.2_thermistor_schematic_2.png


å®Ÿé¨“æ‰‹é †
-----------------------

**ã‚¹ãƒ†ãƒƒãƒ— 1:** å›è·¯ã‚’çµ„ã¿ç«‹ã¦ã¾ã™ã€‚

.. image:: ../python_pi5/img/2.2.2_thermistor_circuit.png

**ã‚¹ãƒ†ãƒƒãƒ— 2:** ã‚³ãƒ¼ãƒ‰ã®ãƒ•ã‚©ãƒ«ãƒ€ã«ç§»å‹•ã—ã¾ã™ã€‚

.. raw:: html

   <run></run>

.. code-block:: 

    cd ~/raphael-kit/python-pi5

**ã‚¹ãƒ†ãƒƒãƒ— 3:** å®Ÿè¡Œå¯èƒ½ãƒ•ã‚¡ã‚¤ãƒ«ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

.. raw:: html

   <run></run>

.. code-block:: 

    sudo python3 2.2.2_Thermistor_zero.py

ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè¡Œã™ã‚‹ã¨ã€ã‚µãƒ¼ãƒŸã‚¹ã‚¿ãŒå‘¨å›²ã®æ¸©åº¦ã‚’æ¤œå‡ºã—ã€ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®è¨ˆç®—ãŒçµ‚äº†ã™ã‚‹ã¨æ¸©åº¦ãŒç”»é¢ã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

.. warning::

    ã‚¨ãƒ©ãƒ¼ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ ``RuntimeError: Cannot determine SOC peripheral base address`` ãŒè¡¨ç¤ºã•ã‚ŒãŸå ´åˆã¯ã€ :ref:`faq_soc` ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

**ã‚³ãƒ¼ãƒ‰**

.. note::

    ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’ **å¤‰æ›´/ãƒªã‚»ãƒƒãƒˆ/ã‚³ãƒ”ãƒ¼/å®Ÿè¡Œ/åœæ­¢** ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ãŸã ã—ã€ãã®å‰ã« ``raphael-kit/python-pi5`` ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ãƒ‘ã‚¹ã«ç§»å‹•ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã‚³ãƒ¼ãƒ‰ã‚’å¤‰æ›´ã—ãŸå¾Œã€åŠ¹æœã‚’ç¢ºèªã™ã‚‹ãŸã‚ã«ç›´æ¥å®Ÿè¡Œã§ãã¾ã™ã€‚


.. raw:: html

    <run></run>

.. code-block:: python

   #!/usr/bin/env python3
   # -*- coding: utf-8 -*-

   import ADC0834
   import time
   import math

   # Initialize the ADC0834 module
   ADC0834.setup()

   # Run the process in a try-except block
   try:
       while True:
           # Read the analog value from the sensor
           analogVal = ADC0834.getResult()

           # Convert the analog value to a voltage
           Vr = 5 * float(analogVal) / 255

           # Calculate the resistance of the thermistor
           Rt = 10000 * Vr / (5 - Vr)

           # Calculate the temperature in Kelvin
           temp = 1 / (((math.log(Rt / 10000)) / 3950) + (1 / (273.15 + 25)))

           # Convert Kelvin to Celsius
           Cel = temp - 273.15

           # Convert Celsius to Fahrenheit
           Fah = Cel * 1.8 + 32

           # Print the temperature in both Celsius and Fahrenheit
           print('Celsius: %.2f C  Fahrenheit: %.2f F' % (Cel, Fah))

           # Wait for 0.2 seconds before the next read
           time.sleep(0.2)

   # Handle KeyboardInterrupt for graceful termination
   except KeyboardInterrupt:
       # Clean up ADC0834 resources
       ADC0834.destroy()


**ã‚³ãƒ¼ãƒ‰ã®èª¬æ˜**

1. ã“ã®ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã¯ã€ã‚¢ãƒŠãƒ­ã‚°-ãƒ‡ã‚¸ã‚¿ãƒ«å¤‰æ›ç”¨ã®ADC0834ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€é…å»¶ã‚’å®Ÿè£…ã™ã‚‹ãŸã‚ã®timeãƒ©ã‚¤ãƒ–ãƒ©ãƒªã€æ•°å­¦çš„æ“ä½œã‚’è¡Œã†ãŸã‚ã®mathãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™ã€‚

   .. code-block:: python

       #!/usr/bin/env python3
       # -*- coding: utf-8 -*-

       import ADC0834
       import time
       import math

2. ã‚¢ãƒŠãƒ­ã‚°å€¤ã®èª­ã¿å–ã‚Šã‚’å¯èƒ½ã«ã™ã‚‹ãŸã‚ã«ADC0834ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚’åˆæœŸåŒ–ã—ã¾ã™ã€‚

   .. code-block:: python

       # Initialize the ADC0834 module
       ADC0834.setup()

3. ç„¡é™ãƒ«ãƒ¼ãƒ—ã‚’å®Ÿè£…ã—ã¦ãƒ‡ãƒ¼ã‚¿ã®é€£ç¶šèª­ã¿å–ã‚Šã‚’è¡Œã„ã¾ã™ã€‚ãƒ«ãƒ¼ãƒ—ã¯ã‚µãƒ¼ãƒŸã‚¹ã‚¿ã‹ã‚‰ã‚¢ãƒŠãƒ­ã‚°å€¤ã‚’èª­ã¿å–ã‚Šã€ã“ã®å€¤ã‚’é›»åœ§ã«å¤‰æ›ã—ã€ã‚µãƒ¼ãƒŸã‚¹ã‚¿ã®æŠµæŠ—ã‚’è¨ˆç®—ã—ã€ãã®æŠµæŠ—ã‚’ã‚±ãƒ«ãƒ“ãƒ³ã€æ‘‚æ°ã€è¯æ°ã®æ¸©åº¦æ¸¬å®šã«å¤‰æ›ã—ã¾ã™ã€‚æ¸©åº¦ã®èª­ã¿å–ã‚Šã‚’æ‘‚æ°ã¨è¯æ°ã®ä¸¡æ–¹ã§å‡ºåŠ›ã—ã€å„èª­ã¿å–ã‚Šã®é–“ã«0.2ç§’ã®å¾…æ©Ÿã‚’æŒ¿å…¥ã—ã¾ã™ã€‚

   .. code-block:: python

       # Run the process in a try-except block
       try:
           while True:
               # Read the analog value from the sensor
               analogVal = ADC0834.getResult()

               # Convert the analog value to a voltage
               Vr = 5 * float(analogVal) / 255

               # Calculate the resistance of the thermistor
               Rt = 10000 * Vr / (5 - Vr)

               # Calculate the temperature in Kelvin
               temp = 1 / (((math.log(Rt / 10000)) / 3950) + (1 / (273.15 + 25)))

               # Convert Kelvin to Celsius
               Cel = temp - 273.15

               # Convert Celsius to Fahrenheit
               Fah = Cel * 1.8 + 32

               # Print the temperature in both Celsius and Fahrenheit
               print('Celsius: %.2f C  Fahrenheit: %.2f F' % (Cel, Fah))

               # Wait for 0.2 seconds before the next read
               time.sleep(0.2)


4. ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’æ­£å¸¸ã«çµ‚äº†ã™ã‚‹ãŸã‚ã®KeyboardInterruptä¾‹å¤–ã‚’ã‚­ãƒ£ãƒƒãƒã—ã€çµ‚äº†æ™‚ã«ADC0834ã®ãƒªã‚½ãƒ¼ã‚¹ã‚’ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—ã™ã‚‹å‘½ä»¤ã‚’å«ã‚ã¦ã„ã¾ã™ã€‚

   .. code-block:: python

       # Handle KeyboardInterrupt for graceful termination
       except KeyboardInterrupt:
           # Clean up ADC0834 resources
           ADC0834.destroy()
