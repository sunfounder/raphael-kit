.. nota::

    隆Hola, bienvenido a la comunidad de entusiastas de SunFounder Raspberry Pi & Arduino & ESP32 en Facebook! Sum茅rgete m谩s en Raspberry Pi, Arduino y ESP32 con otros entusiastas.

    **驴Por qu茅 unirse?**

    - **Soporte experto**: Resuelve problemas postventa y desaf铆os t茅cnicos con la ayuda de nuestra comunidad y equipo.
    - **Aprender y compartir**: Intercambia consejos y tutoriales para mejorar tus habilidades.
    - **Avances exclusivos**: Obt茅n acceso anticipado a anuncios de nuevos productos y adelantos.
    - **Descuentos especiales**: Disfruta de descuentos exclusivos en nuestros productos m谩s recientes.
    - **Promociones y sorteos festivos**: Participa en sorteos y promociones de temporada.

     驴Listo para explorar y crear con nosotros? Haz clic en [|link_sf_facebook|] y 煤nete hoy mismo!

.. _2.2.6_py_pi5:

2.2.6 M贸dulo Sensor de Velocidad
=====================================

Introducci贸n
------------------

En este proyecto, aprenderemos el uso del m贸dulo sensor de velocidad. Un m贸dulo sensor de velocidad es un tipo de tac贸metro que se utiliza para medir la velocidad de un objeto rotativo como un motor.

Componentes Necesarios
----------------------------

En este proyecto, necesitamos los siguientes componentes. 

.. image:: ../python_pi5/img/2.2.6_photo_interrrupter_list.png
    :width: 700
    :align: center

Es definitivamente conveniente comprar un kit completo, aqu铆 est谩 el enlace: 

.. list-table::
    :widths: 20 20 20
    :header-rows: 1

    *   - Nombre
        - ARTCULOS EN ESTE KIT
        - ENLACE
    *   - Kit Raphael
        - 337
        - |link_Raphael_kit|

Tambi茅n puedes comprarlos por separado en los enlaces a continuaci贸n.

.. list-table::
    :widths: 30 20
    :header-rows: 1

    *   - INTRODUCCIN DEL COMPONENTE
        - ENLACE DE COMPRA

    *   - :ref:`cpn_gpio_extension_board`
        - |link_gpio_board_buy|
    *   - :ref:`cpn_breadboard`
        - |link_breadboard_buy|
    *   - :ref:`cpn_wires`
        - |link_wires_buy|
    *   - :ref:`cpn_resistor`
        - |link_resistor_buy|
    *   - :ref:`cpn_led`
        - |link_led_buy|
    *   - :ref:`cpn_speed_sensor`
        - \-

Diagrama Esquem谩tico
-------------------------

.. image:: ../python_pi5/img/2.2.6_photo_interrrupter_schematic.png
    :width: 400
    :align: center

Procedimientos Experimentales
---------------------------------

**Paso 1:** Construir el circuito.

.. image:: ../python_pi5/img/2.2.6_photo_interrrupter_circuit.png
    :width: 700
    :align: center

**Paso 2:** Cambiar de directorio.

.. raw:: html

   <run></run>

.. code-block::

    cd ~/raphael-kit/python-pi5

**Paso 3:** Ejecutar.

.. raw:: html

   <run></run>

.. code-block::

    sudo python3 2.2.6_speed_sensor_module_zero.py

Despu茅s de ejecutar el c贸digo, el LED verde se encender谩. Si colocas un obst谩culo en el hueco del m贸dulo sensor de velocidad, se imprimir谩 "luz bloqueada" en la pantalla y el LED rojo se encender谩.
Retira el obst谩culo y el LED verde se encender谩 de nuevo.

**C贸digo**

.. nota::

    Puedes **Modificar/Restablecer/Copiar/Ejecutar/Detener** el c贸digo a continuaci贸n. Pero antes de eso, necesitas ir a la ruta del c贸digo fuente como ``raphael-kit/python-pi5``. Despu茅s de modificar el c贸digo, puedes ejecutarlo directamente para ver el efecto.

.. raw:: html

    <run></run>

.. code-block:: python

   #!/usr/bin/env python3
   from gpiozero import LED, Button
   from signal import pause

   # Inicializar pines GPIO para el sensor de velocidad y los LEDs utilizando la biblioteca GPIO Zero
   speed_sensor = Button(17, pull_up=False)  # Sensor de velocidad conectado al pin GPIO 17 sin pull-up
   green_led = LED(27)                      # LED verde conectado al pin GPIO 27
   red_led = LED(22)                        # LED rojo conectado al pin GPIO 22

   def update_leds():
       """
       Update the state of LEDs based on the speed sensor.
       - If the sensor is pressed (triggered), the red LED is turned on and a message is printed.
       - If the sensor is released (not triggered), the green LED is turned on.
       """
       if speed_sensor.is_pressed:
           green_led.off()  # Turn off green LED
           red_led.on()     # Turn on red LED
           print('Light was blocked')  # Print message indicating sensor is triggered
       else:
           green_led.on()   # Encender LED verde
           red_led.off()    # Apagar LED rojo

   try:
       # Bucle principal para verificar continuamente el estado del sensor
       while True:
           # Actualizar LEDs basado en cambios en el estado del sensor
           speed_sensor.when_pressed = update_leds   # Actualizar LEDs cuando el sensor est谩 presionado
           speed_sensor.when_released = update_leds  # Actualizar LEDs cuando el sensor est谩 liberado

   except KeyboardInterrupt:
       # Manejar KeyboardInterrupt (Ctrl+C) para una terminaci贸n segura del script
       pass


**Explicaci贸n del C贸digo**

#. Se importa la biblioteca ``gpiozero`` para usar sus clases ``LED`` y ``Button`` para interactuar con los pines GPIO. Se importa la biblioteca ``signal`` para usar la funci贸n ``pause``, que se utiliza para mantener el script en ejecuci贸n.

   .. code-block:: python

       #!/usr/bin/env python3
       from gpiozero import LED, Button
       from signal import pause

#. El sensor de velocidad se configura como un ``Button`` en el pin GPIO 17. El par谩metro ``pull_up=False`` indica que no se utiliza la resistencia pull-up interna. ``green_led`` y ``red_led`` se inicializan como objetos ``LED`` conectados a los pines GPIO 27 y 22, respectivamente.

   .. code-block:: python

       # Inicializar pines GPIO para el sensor de velocidad y los LEDs utilizando la biblioteca GPIO Zero
       speed_sensor = Button(17, pull_up=False)  # Sensor de velocidad conectado al pin GPIO 17 sin pull-up
       green_led = LED(27)                      # LED verde conectado al pin GPIO 27
       red_led = LED(22)                        # LED rojo conectado al pin GPIO 22

#. La funci贸n ``update_leds`` verifica el estado del sensor de velocidad. Si el sensor est谩 presionado (activado), apaga el LED verde, enciende el LED rojo e imprime un mensaje. Si el sensor est谩 liberado, hace lo contrario.

   .. code-block:: python

       def update_leds():
           """
           Update the state of LEDs based on the speed sensor.
           - If the sensor is pressed (triggered), the red LED is turned on and a message is printed.
           - If the sensor is released (not triggered), the green LED is turned on.
           """
           if speed_sensor.is_pressed:
               green_led.off()  # Turn off green LED
               red_led.on()     # Turn on red LED
               print('Light was blocked')  # Print message indicating sensor is triggered
           else:
               green_led.on()   # Encender LED verde
               red_led.off()    # Apagar LED rojo

#. El bucle principal verifica continuamente el estado del sensor de velocidad. Los atributos ``when_pressed`` y ``when_released`` son manejadores de eventos que llaman a la funci贸n ``update_leds`` cuando el estado del sensor cambia. El bloque try-except se utiliza para manejar una excepci贸n KeyboardInterrupt para una salida limpia.

   .. code-block:: python

       try:
           # Bucle principal para verificar continuamente el estado del sensor
           while True:
               # Actualizar LEDs basado en cambios en el estado del sensor
               speed_sensor.when_pressed = update_leds   # Actualizar LEDs cuando el sensor est谩 presionado
               speed_sensor.when_released = update_leds  # Actualizar LEDs cuando el sensor est谩 liberado

       except KeyboardInterrupt:
           # Manejar KeyboardInterrupt (Ctrl+C) para una terminaci贸n segura del script
           pass











