.. note::

    ã“ã‚“ã«ã¡ã¯ã€SunFounderã®Raspberry Pi & Arduino & ESP32æ„›å¥½å®¶ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã¸ã‚ˆã†ã“ãï¼Facebookä¸Šã§Raspberry Piã€Arduinoã€ESP32ã«ã¤ã„ã¦ã‚‚ã£ã¨æ·±ãæ˜ã‚Šä¸‹ã’ã€ä»–ã®æ„›å¥½å®¶ã¨äº¤æµã—ã¾ã—ã‚‡ã†ã€‚

    **å‚åŠ ã™ã‚‹ç†ç”±ã¯ï¼Ÿ**

    - **ã‚¨ã‚­ã‚¹ãƒ‘ãƒ¼ãƒˆã‚µãƒãƒ¼ãƒˆ**ï¼šã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã‚„ãƒãƒ¼ãƒ ã®åŠ©ã‘ã‚’å€Ÿã‚Šã¦ã€è²©å£²å¾Œã®å•é¡Œã‚„æŠ€è¡“çš„ãªèª²é¡Œã‚’è§£æ±ºã—ã¾ã™ã€‚
    - **å­¦ã³ï¼†å…±æœ‰**ï¼šãƒ’ãƒ³ãƒˆã‚„ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã‚’äº¤æ›ã—ã¦ã‚¹ã‚­ãƒ«ã‚’å‘ä¸Šã•ã›ã¾ã—ã‚‡ã†ã€‚
    - **ç‹¬å çš„ãªãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼**ï¼šæ–°è£½å“ã®ç™ºè¡¨ã‚„å…ˆè¡Œãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã«æ—©æœŸã‚¢ã‚¯ã‚»ã‚¹ã—ã¾ã—ã‚‡ã†ã€‚
    - **ç‰¹åˆ¥å‰²å¼•**ï¼šæœ€æ–°è£½å“ã®ç‹¬å å‰²å¼•ã‚’ãŠæ¥½ã—ã¿ãã ã•ã„ã€‚
    - **ç¥­ã‚Šã®ãƒ—ãƒ­ãƒ¢ãƒ¼ã‚·ãƒ§ãƒ³ã¨ã‚®ãƒ•ãƒˆ**ï¼šã‚®ãƒ•ãƒˆã‚„ç¥æ—¥ã®ãƒ—ãƒ­ãƒ¢ãƒ¼ã‚·ãƒ§ãƒ³ã«å‚åŠ ã—ã¾ã—ã‚‡ã†ã€‚

    ğŸ‘‰ ç§ãŸã¡ã¨ä¸€ç·’ã«æ¢ç´¢ã—ã€å‰µé€ ã™ã‚‹æº–å‚™ã¯ã§ãã¦ã„ã¾ã™ã‹ï¼Ÿ[|link_sf_facebook|]ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ä»Šã™ãå‚åŠ ã—ã¾ã—ã‚‡ã†ï¼

.. _4.1.17_py_pi5:

4.1.14 ã‚²ãƒ¼ãƒ  â€“ æ•°å½“ã¦
==============================

ã¯ã˜ã‚ã«
------------------

æ•°å½“ã¦ã¯ã€ã‚ãªãŸã¨å‹é”ãŒäº¤äº’ã«æ•°å­—ï¼ˆ0ã€œ99ï¼‰ã‚’å…¥åŠ›ã™ã‚‹æ¥½ã—ã„ãƒ‘ãƒ¼ãƒ†ã‚£ãƒ¼ã‚²ãƒ¼ãƒ ã§ã™ã€‚æ•°å­—ã®å…¥åŠ›ã«å¾“ã£ã¦ã€ç¯„å›²ã¯ç‹­ã¾ã£ã¦ã„ãã€ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ãŒè¬ã‚’æ­£ã—ãè§£ç­”ã™ã‚‹ã¾ã§ç¶šãã¾ã™ã€‚ãã®å¾Œã€ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¯è² ã‘ã¦ç½°ã›ã‚‰ã‚Œã¾ã™ã€‚ãŸã¨ãˆã°ã€å¹¸é‹ã®æ•°å­—ãŒ51ã§ã€ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼1ãŒ50ã‚’å…¥åŠ›ã—ãŸå ´åˆã€æ•°å­—ã®ç¯„å›²ã¯50ã€œ99ã«å¤‰ã‚ã‚Šã¾ã™ã€‚ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼2ãŒ70ã‚’å…¥åŠ›ã™ã‚‹ã¨ã€æ•°å­—ã®ç¯„å›²ã¯50ã€œ70ã«ãªã‚Šã¾ã™ã€‚ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼3ãŒ51ã‚’å…¥åŠ›ã—ãŸå ´åˆã€ãã®ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼ã¯ä¸é‹ã§ã™ã€‚ã“ã“ã§ã¯ã€ã‚­ãƒ¼ãƒ‘ãƒƒãƒ‰ã‚’ä½¿ç”¨ã—ã¦æ•°å­—ã‚’å…¥åŠ›ã—ã€LCDã‚’ä½¿ç”¨ã—ã¦çµæœã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

å¿…è¦ãªéƒ¨å“
------------------------------

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã«ã¯ã€æ¬¡ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãŒå¿…è¦ã§ã™ã€‚

.. image:: ../python_pi5/img/4.1.17_game_guess_number_list.png
    :width: 800
    :align: center

ä¸€å¼ã‚’è³¼å…¥ã™ã‚‹ã®ãŒä¾¿åˆ©ã§ã™ã€ã“ã¡ã‚‰ãŒãƒªãƒ³ã‚¯ã§ã™ï¼š 

.. list-table::
    :widths: 20 20 20
    :header-rows: 1

    *   - åå‰	
        - ã“ã®ã‚­ãƒƒãƒˆã®ã‚¢ã‚¤ãƒ†ãƒ 
        - ãƒªãƒ³ã‚¯
    *   - Raphael Kit
        - 337
        - |link_Raphael_kit|

ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯ã‹ã‚‰åˆ¥ã€…ã«è³¼å…¥ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

.. list-table::
    :widths: 30 20
    :header-rows: 1

    *   - ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ç´¹ä»‹
        - è³¼å…¥ãƒªãƒ³ã‚¯

    *   - :ref:`cpn_gpio_board`
        - |link_gpio_board_buy|
    *   - :ref:`cpn_breadboard`
        - |link_breadboard_buy|
    *   - :ref:`cpn_wires`
        - |link_wires_buy|
    *   - :ref:`cpn_resistor`
        - |link_resistor_buy|
    *   - :ref:`cpn_keypad`
        - \-
    *   - :ref:`cpn_i2c_lcd`
        - |link_i2clcd1602_buy|


å›è·¯å›³
-----------------------

============ ======== ======== =======
T-Board Name physical wiringPi BCM
GPIO18       Pin 12   1        18
GPIO23       Pin 16   4        23
GPIO24       Pin 18   5        24
GPIO25       Pin 22   6        25
SPIMOSI      Pin 19   12       10
GPIO22       Pin 15   3        22
GPIO27       Pin 13   2        27
GPIO17       Pin 11   0        17
SDA1         Pin 3    SDA1(8)  SDA1(2)
SCL1         Pin 5    SCL1(9)  SDA1(3)
============ ======== ======== =======

.. image:: ../python_pi5/img/4.1.17_game_guess_number_schematic.png
   :align: center

å®Ÿé¨“æ‰‹é †
-----------------------------

**ã‚¹ãƒ†ãƒƒãƒ— 1:** å›è·¯ã‚’çµ„ã¿ç«‹ã¦ã¾ã™ã€‚

.. image:: ../python_pi5/img/4.1.17_game_guess_number_circuit.png

**ã‚¹ãƒ†ãƒƒãƒ— 2**: I2Cã‚’ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã—ã¾ã™ï¼ˆè©³ç´°ã¯ :ref:`i2c_config` ã‚’å‚ç…§ï¼‰ã€‚

**ã‚¹ãƒ†ãƒƒãƒ— 3**: ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’å¤‰æ›´ã—ã¾ã™ã€‚

.. raw:: html

   <run></run>

.. code-block:: 

    cd ~/raphael-kit/python-pi5

**ã‚¹ãƒ†ãƒƒãƒ— 4**: å®Ÿè¡Œã—ã¾ã™ã€‚

.. raw:: html

   <run></run>

.. code-block:: 

    sudo python3 3.1.12_GAME_GuessNumber_zero.py

ãƒ—ãƒ­ã‚°ãƒ©ãƒ ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã¨ã€LCDã«åˆæœŸãƒšãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ï¼š

.. code-block:: 

   Welcome!
   Press A to go!

'A'ãƒœã‚¿ãƒ³ã‚’æŠ¼ã™ã¨ã€ã‚²ãƒ¼ãƒ ãŒé–‹å§‹ã—ã€LCDã«ã‚²ãƒ¼ãƒ ãƒšãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

.. code-block:: 

   Enter number:
   0 < point < 99

ãƒ©ãƒ³ãƒ€ãƒ ãªæ•°å­— 'â€¹pointâ€¹' ãŒã‚²ãƒ¼ãƒ é–‹å§‹æ™‚ã«ç”Ÿæˆã•ã‚Œã¾ã™ãŒã€LCDã«ã¯è¡¨ç¤ºã•ã‚Œã¾ã›ã‚“ã€‚å¿…è¦ãªã“ã¨ã¯ã€ãã‚Œã‚’æ¨æ¸¬ã™ã‚‹ã“ã¨ã§ã™ã€‚å…¥åŠ›ã—ãŸæ•°å€¤ã¯ã€æœ€çµ‚çš„ãªè¨ˆç®—ãŒçµ‚äº†ã™ã‚‹ã¾ã§ã€æœ€åˆã®è¡Œã®æœ«å°¾ã«è¡¨ç¤ºã•ã‚Œã¾ã™ï¼ˆæ¯”è¼ƒã‚’é–‹å§‹ã™ã‚‹ã«ã¯ 'D' ã‚’æŠ¼ã—ã€å…¥åŠ›ã•ã‚ŒãŸæ•°å€¤ãŒ **10** ã‚ˆã‚Šå¤§ãã„å ´åˆã€è‡ªå‹•çš„ãªæ¯”è¼ƒãŒé–‹å§‹ã•ã‚Œã¾ã™ï¼‰ã€‚

'â€¹pointâ€¹' ã®æ•°å€¤ç¯„å›²ãŒ2è¡Œç›®ã«è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚æŒ‡å®šã•ã‚ŒãŸç¯„å›²å†…ã§æ•°å€¤ã‚’å…¥åŠ›ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚æ•°å€¤ã‚’å…¥åŠ›ã™ã‚‹ã¨ã€ç¯„å›²ãŒç‹­ã¾ã‚Šã€å¹¸é‹ã‹ä¸é‹ã‹ã«ã‹ã‹ã‚ã‚‰ãšã€ ``å½“ãŸã‚Šã¾ã—ãŸï¼`` ã¨è¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

.. note::

    * ã‚¨ãƒ©ãƒ¼ ``FileNotFoundError: [Errno 2] No such file or directory: '/dev/i2c-1'`` ãŒè¡¨ç¤ºã•ã‚Œã‚‹å ´åˆã€I2Cã‚’æœ‰åŠ¹ã«ã™ã‚‹ã«ã¯ :ref:`i2c_config` ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚
    * ã‚¨ãƒ©ãƒ¼ ``ModuleNotFoundError: No module named 'smbus2'`` ãŒè¡¨ç¤ºã•ã‚Œã‚‹å ´åˆã€ ``sudo pip3 install smbus2`` ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚
    * ã‚¨ãƒ©ãƒ¼ ``OSError: [Errno 121] Remote I/O error`` ãŒè¡¨ç¤ºã•ã‚Œã‚‹å ´åˆã€ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®æ¥ç¶šãŒèª¤ã£ã¦ã„ã‚‹ã‹ã€ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ãŒå£Šã‚Œã¦ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚
    * ã‚³ãƒ¼ãƒ‰ã¨é…ç·šãŒæ­£å¸¸ã§ã‚ã‚‹ã«ã‚‚ã‹ã‹ã‚ã‚‰ãšã€LCDã«ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ãŒè¡¨ç¤ºã•ã‚Œãªã„å ´åˆã¯ã€èƒŒé¢ã®ãƒãƒ†ãƒ³ã‚·ãƒ§ãƒ¡ãƒ¼ã‚¿ãƒ¼ã‚’å›ã—ã¦ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆã‚’ä¸Šã’ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

.. warning::

    ã‚¨ãƒ©ãƒ¼ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ ``RuntimeError: Cannot determine SOC peripheral base address`` ãŒè¡¨ç¤ºã•ã‚ŒãŸå ´åˆã¯ã€ :ref:`faq_soc` ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

**ã‚³ãƒ¼ãƒ‰**


.. note::
    ä»¥ä¸‹ã®ã‚³ãƒ¼ãƒ‰ã‚’ **ä¿®æ­£/ãƒªã‚»ãƒƒãƒˆ/ã‚³ãƒ”ãƒ¼/å®Ÿè¡Œ/åœæ­¢** ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚ãŸã ã—ã€ãã®å‰ã« ``raphael-kit/python-pi5`` ã®ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ãƒ‘ã‚¹ã«ç§»å‹•ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚

.. raw:: html

    <run></run>

.. code-block:: python

   #!/usr/bin/env python3

   from gpiozero import DigitalOutputDevice, Button
   from time import sleep
   import LCD1602
   import random

   class Keypad:
      def __init__(self, rows_pins, cols_pins, keys):
         """
         Initialize the keypad with specified row and column pins and key layout.
         :param rows_pins: List of GPIO pins for the rows.
         :param cols_pins: List of GPIO pins for the columns.
         :param keys: Layout of keys on the keypad.
         """
         self.rows = [DigitalOutputDevice(pin) for pin in rows_pins]  # Setup row pins
         self.cols = [Button(pin, pull_up=False) for pin in cols_pins]  # Setup column pins
         self.keys = keys  # Define keypad layout

      def read(self):
         """
         Read and return the currently pressed keys.
         :return: List of pressed keys.
         """
         pressed_keys = []
         for i, row in enumerate(self.rows):
               row.on()  # Activate current row
               for j, col in enumerate(self.cols):
                  if col.is_pressed:
                     index = i * len(self.cols) + j
                     pressed_keys.append(self.keys[index])  # Append pressed key
               row.off()  # Deactivate row
         return pressed_keys

   # Game-related variables
   count = 0
   pointValue = 0
   upper = 99
   lower = 0

   def setup():
      """
      Setup function for initializing the keypad and LCD display.
      """
      global keypad, last_key_pressed, keys
      rowsPins = [18, 23, 24, 25]
      colsPins = [10, 22, 27, 17]
      keys = ["1", "2", "3", "A",
               "4", "5", "6", "B",
               "7", "8", "9", "C",
               "*", "0", "#", "D"]
      keypad = Keypad(rowsPins, colsPins, keys)
      last_key_pressed = []
      LCD1602.init(0x27, 1)  # Initialize LCD
      LCD1602.clear()
      LCD1602.write(0, 0, 'Welcome!')
      LCD1602.write(0, 1, 'Press A to Start!')

   def init_new_value():
      """
      Initialize a new target value and reset game parameters.
      """
      global pointValue, upper, lower, count
      pointValue = random.randint(0, 99)
      upper = 99
      lower = 0
      count = 0
      print('point is %d' % pointValue)

   def detect_point():
      """
      Check if the guessed number is the target, too high, or too low.
      :return: 1 if correct guess, 0 otherwise.
      """
      global count, upper, lower
      if count > pointValue and count < upper:
         upper = count
      elif count < pointValue and count > lower:
         lower = count
      elif count == pointValue:
         count = 0
         return 1
      count = 0
      return 0

   def lcd_show_input(result):
      """
      Display the current game state and results on the LCD.
      :param result: Result of the last guess (0 or 1).
      """
      LCD1602.clear()
      if result == 1:
         LCD1602.write(0, 1, 'You have got it!')
         sleep(5)
         init_new_value()
         lcd_show_input(0)
      else:
         LCD1602.write(0, 0, 'Enter number:')
         LCD1602.write(13, 0, str(count))
         LCD1602.write(0, 1, str(lower))
         LCD1602.write(3, 1, ' < Point < ')
         LCD1602.write(13, 1, str(upper))

   def loop():
      """
      Main game loop for handling keypad input and updating game state.
      """
      global keypad, last_key_pressed, count
      while True:
         result = 0
         pressed_keys = keypad.read()
         if pressed_keys and pressed_keys != last_key_pressed:
               if pressed_keys == ["A"]:
                  init_new_value()
                  lcd_show_input(0)
               elif pressed_keys == ["D"]:
                  result = detect_point()
                  lcd_show_input(result)
               elif pressed_keys[0] in keys:
                  if pressed_keys[0] in ["A", "B", "C", "D", "#", "*"]:
                     continue
                  count = count * 10 + int(pressed_keys[0])
                  if count >= 10:
                     result = detect_point()
                  lcd_show_input(result)
               print(pressed_keys)
         last_key_pressed = pressed_keys
         sleep(0.1)

   try:
      setup()
      loop()
   except KeyboardInterrupt:
      LCD1602.clear()  # Clear LCD on interrupt


**ã‚³ãƒ¼ãƒ‰èª¬æ˜**

#. GPIO Zeroãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‹ã‚‰ãƒ‡ã‚¸ã‚¿ãƒ«å‡ºåŠ›ãƒ‡ãƒã‚¤ã‚¹ã¨ãƒœã‚¿ãƒ³ã®ãŸã‚ã®é‡è¦ãªã‚¯ãƒ©ã‚¹ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã™ã‚‹ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ã™ã€‚ã‚¹ã‚¯ãƒªãƒ—ãƒˆå†…ã§é…å»¶ã‚’å°å…¥ã™ã‚‹ãŸã‚ã«ã€timeãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã®sleepé–¢æ•°ã‚‚å«ã¾ã‚Œã¦ã„ã¾ã™ã€‚LCD1602ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¯ã€ãƒ†ã‚­ã‚¹ãƒˆã‚„ãƒ‡ãƒ¼ã‚¿å‡ºåŠ›ã‚’è¡¨ç¤ºã™ã‚‹ãŸã‚ã«å½¹ç«‹ã¤LCDãƒ‡ã‚£ã‚¹ãƒ—ãƒ¬ã‚¤ã®æ“ä½œã«åˆ©ç”¨ã•ã‚Œã¾ã™ã€‚ã•ã‚‰ã«ã€ãƒ©ãƒ³ãƒ€ãƒ ãªæ•°å­—ã‚’ç”Ÿæˆã™ã‚‹ãŸã‚ã®é–¢æ•°ã‚’æä¾›ã™ã‚‹randomãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚‚çµ„ã¿è¾¼ã¾ã‚Œã¦ã„ã¾ã™ã€‚ã“ã‚Œã¯ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ã•ã¾ã–ã¾ãªé¢ã§æœ‰åˆ©ã«ãªã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚

   .. code-block:: python

      #!/usr/bin/env python3

      from gpiozero import DigitalOutputDevice, Button
      from time import sleep
      import LCD1602
      import random

#. ã‚­ãƒ¼ãƒ‘ãƒƒãƒ‰ã®ã‚¯ãƒ©ã‚¹ã‚’å®šç¾©ã—ã€è¡Œã¨åˆ—ã®ãƒ”ãƒ³ã§åˆæœŸåŒ–ã—ã€æŠ¼ã•ã‚ŒãŸã‚­ãƒ¼ã‚’èª­ã¿å–ã‚‹ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å®šç¾©ã—ã¾ã™ã€‚

   .. code-block:: python

      class Keypad:
         def __init__(self, rows_pins, cols_pins, keys):
            """
            Initialize the keypad with specified row and column pins and key layout.
            :param rows_pins: List of GPIO pins for the rows.
            :param cols_pins: List of GPIO pins for the columns.
            :param keys: Layout of keys on the keypad.
            """
            self.rows = [DigitalOutputDevice(pin) for pin in rows_pins]  # Setup row pins
            self.cols = [Button(pin, pull_up=False) for pin in cols_pins]  # Setup column pins
            self.keys = keys  # Define keypad layout

         def read(self):
            """
            Read and return the currently pressed keys.
            :return: List of pressed keys.
            """
            pressed_keys = []
            for i, row in enumerate(self.rows):
                  row.on()  # Activate current row
                  for j, col in enumerate(self.cols):
                     if col.is_pressed:
                        index = i * len(self.cols) + j
                        pressed_keys.append(self.keys[index])  # Append pressed key
                  row.off()  # Deactivate row
            return pressed_keys

#. ã‚²ãƒ¼ãƒ ã«é–¢é€£ã™ã‚‹å¤‰æ•° ``count`` ã‚’ã‚¼ãƒ­ã¨ã—ã¦åˆæœŸåŒ–ã—ã€ã‚­ãƒ¼ãƒ‘ãƒƒãƒ‰ã¨LCDãƒ‡ã‚£ã‚¹ãƒ—ãƒ¬ã‚¤ã‚’è¨­å®šã—ã€ã‚¦ã‚§ãƒ«ã‚«ãƒ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¨æŒ‡ç¤ºã‚’è¡¨ç¤ºã—ã¾ã™ã€‚ã‚²ãƒ¼ãƒ ã§ã®ç‰¹å®šã®ã‚¹ã‚³ã‚¢ã‚„å€¤ã‚’è¡¨ã™å¯èƒ½æ€§ãŒã‚ã‚‹ ``pointValue`` å¤‰æ•°ã‚’ã‚¼ãƒ­ã«åˆæœŸåŒ–ã—ã¾ã™ã€‚å½“åˆã¯99ã«è¨­å®šã•ã‚ŒãŸ ``upper`` ã¯ã€æ•°å­—å½“ã¦ã‚²ãƒ¼ãƒ ã®æœ€å¤§å€¤ã¨ã—ã¦ä½¿ç”¨ã•ã‚Œã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ã‚²ãƒ¼ãƒ ã®æœ€å°å¢ƒç•Œã¨ã—ã¦ä½¿ç”¨ã•ã‚Œã‚‹å¯èƒ½æ€§ã®ã‚ã‚‹ã‚¼ãƒ­ã‹ã‚‰ã® ``lower`` é™ç•Œã‚’è¨­å®šã—ã¾ã™ã€‚

   .. code-block:: python

      # Game-related variables
      count = 0
      pointValue = 0
      upper = 99
      lower = 0


#. ã‚­ãƒ¼ãƒ‘ãƒƒãƒ‰ã¨LCDãƒ‡ã‚£ã‚¹ãƒ—ãƒ¬ã‚¤ã‚’è¨­å®šã—ã€ã‚¦ã‚§ãƒ«ã‚«ãƒ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¨æŒ‡ç¤ºã‚’è¡¨ç¤ºã—ã¾ã™ã€‚

   .. code-block:: python

      def setup():
         """
         Setup function for initializing the keypad and LCD display.
         """
         global keypad, last_key_pressed, keys
         rowsPins = [18, 23, 24, 25]
         colsPins = [10, 22, 27, 17]
         keys = ["1", "2", "3", "A",
                  "4", "5", "6", "B",
                  "7", "8", "9", "C",
                  "*", "0", "#", "D"]
         keypad = Keypad(rowsPins, colsPins, keys)
         last_key_pressed = []
         LCD1602.init(0x27, 1)  # Initialize LCD
         LCD1602.clear()
         LCD1602.write(0, 0, 'Welcome!')
         LCD1602.write(0, 1, 'Press A to Start!')

#. æ–°ã—ã„ã‚¿ãƒ¼ã‚²ãƒƒãƒˆå€¤ã‚’åˆæœŸåŒ–ã—ã€ã‚²ãƒ¼ãƒ ã®ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ãƒªã‚»ãƒƒãƒˆã—ã¾ã™ã€‚

   .. code-block:: python

      def init_new_value():
         """
         Initialize a new target value and reset game parameters.
         """
         global pointValue, upper, lower, count
         pointValue = random.randint(0, 99)
         upper = 99
         lower = 0
         count = 0
         print('point is %d' % pointValue)


#. æ¨æ¸¬ã•ã‚ŒãŸæ•°å­—ãŒã‚¿ãƒ¼ã‚²ãƒƒãƒˆã¨ä¸€è‡´ã™ã‚‹ã‹ã©ã†ã‹ã‚’ãƒã‚§ãƒƒã‚¯ã—ã€ãã‚Œã«å¿œã˜ã¦æ¨æ¸¬ç¯„å›²ã‚’æ›´æ–°ã—ã¾ã™ã€‚

   .. code-block:: python

      def detect_point():
         """
         Check if the guessed number is the target, too high, or too low.
         :return: 1 if correct guess, 0 otherwise.
         """
         global count, upper, lower
         if count > pointValue and count < upper:
            upper = count
         elif count < pointValue and count > lower:
            lower = count
         elif count == pointValue:
            count = 0
            return 1
         count = 0
         return 0


#. LCDã«ã‚²ãƒ¼ãƒ ã®çŠ¶æ…‹ã‚’è¡¨ç¤ºã—ã€ç¾åœ¨ã®æ¨æ¸¬ã€ç¯„å›²ã€çµæœã‚’ç¤ºã—ã¾ã™ã€‚

   .. code-block:: python

      def lcd_show_input(result):
         """
         Display the current game state and results on the LCD.
         :param result: Result of the last guess (0 or 1).
         """
         LCD1602.clear()
         if result == 1:
            LCD1602.write(0, 1, 'You have got it!')
            sleep(5)
            init_new_value()
            lcd_show_input(0)
         else:
            LCD1602.write(0, 0, 'Enter number:')
            LCD1602.write(13, 0, str(count))
            LCD1602.write(0, 1, str(lower))
            LCD1602.write(3, 1, ' < Point < ')
            LCD1602.write(13, 1, str(upper))

#. ã‚­ãƒ¼ãƒ‘ãƒƒãƒ‰å…¥åŠ›ã®å‡¦ç†ã€ã‚²ãƒ¼ãƒ ã®çŠ¶æ…‹ã®æ›´æ–°ã€LCDã¸ã®çµæœã®è¡¨ç¤ºã‚’è¡Œã†ãƒ¡ã‚¤ãƒ³ãƒ«ãƒ¼ãƒ—ã§ã™ã€‚

   .. code-block:: python

      def loop():
         """
         Main game loop for handling keypad input and updating game state.
         """
         global keypad, last_key_pressed, count
         while True:
            result = 0
            pressed_keys = keypad.read()
            if pressed_keys and pressed_keys != last_key_pressed:
                  if pressed_keys == ["A"]:
                     init_new_value()
                     lcd_show_input(0)
                  elif pressed_keys == ["D"]:
                     result = detect_point()
                     lcd_show_input(result)
                  elif pressed_keys[0] in keys:
                     if pressed_keys[0] in ["A", "B", "C", "D", "#", "*"]:
                        continue
                     count = count * 10 + int(pressed_keys[0])
                     if count >= 10:
                        result = detect_point()
                     lcd_show_input(result)
                  print(pressed_keys)
            last_key_pressed = pressed_keys
            sleep(0.1)

#. ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚’å®Ÿè¡Œã—ã€ãƒ¡ã‚¤ãƒ³ã‚²ãƒ¼ãƒ ãƒ«ãƒ¼ãƒ—ã«å…¥ã‚Šã¾ã™ã€‚ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰å‰²ã‚Šè¾¼ã¿ã‚’ä½¿ç”¨ã—ã¦ã‚¯ãƒªãƒ¼ãƒ³ãªçµ‚äº†ãŒå¯èƒ½ã§ã™ã€‚

   .. code-block:: python

      try:
         setup()
         loop()
      except KeyboardInterrupt:
         LCD1602.clear()  # Clear LCD on interrupt
