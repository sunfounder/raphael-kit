.. note::

    춰Hola, bienvenido a la Comunidad de Entusiastas de SunFounder Raspberry Pi & Arduino & ESP32 en Facebook! Sum칠rgete m치s en Raspberry Pi, Arduino y ESP32 con otros entusiastas.

    **쯇or qu칠 unirte?**

    - **Soporte experto**: Resuelve problemas postventa y desaf칤os t칠cnicos con la ayuda de nuestra comunidad y equipo.
    - **Aprende y comparte**: Intercambia consejos y tutoriales para mejorar tus habilidades.
    - **Avances exclusivos**: Obt칠n acceso anticipado a nuevos anuncios de productos y adelantos.
    - **Descuentos especiales**: Disfruta de descuentos exclusivos en nuestros productos m치s nuevos.
    - **Promociones y sorteos festivos**: Participa en sorteos y promociones navide침as.

    游녤 쯃isto para explorar y crear con nosotros? Haz clic en [|link_sf_facebook|] y 칰nete hoy mismo!

.. _3.1.1_py_pi5:

3.1.1 M칩dulo Fotogr치fico
=============================

Introducci칩n
--------------------

En este kit, equipado con un m칩dulo de c치mara, intentemos tomar una foto con Raspberry Pi.

Componentes Necesarios
-------------------------------

En este proyecto, necesitamos los siguientes componentes.

.. image:: ../python_pi5/img/3.3.1_photograph_list.png
  :width: 800

Es definitivamente conveniente comprar un kit completo, aqu칤 est치 el enlace:

.. list-table::
    :widths: 20 20 20
    :header-rows: 1

    *   - Nombre	
        - ART칈CULOS EN ESTE KIT
        - ENLACE
    *   - Kit Raphael
        - 337
        - |link_Raphael_kit|

Tambi칠n puedes comprarlos por separado en los enlaces a continuaci칩n.

.. list-table::
    :widths: 30 20
    :header-rows: 1

    *   - INTRODUCCI칍N DEL COMPONENTE
        - ENLACE DE COMPRA

    *   - :ref:`cpn_camera_module`
        - |link_camera_buy|

Procedimientos Experimentales
-------------------------------------

**Paso 1:** Accede al Escritorio de Raspberry Pi. Es posible que necesites una pantalla para una mejor experiencia, consulta: `Connect your Raspberry Pi <https://projects.raspberrypi.org/en/projects/raspberry-pi-setting-up/3>`_. O accede al escritorio de Raspberry Pi de forma remota, para un tutorial detallado consulta :ref:`remote_desktop`.

**Paso 2:** Verifica si la c치mara est치 habilitada. Para obtener instrucciones, consulta: :ref:`enable_camera`.

**Paso 3:** Abre una Terminal y ve a la carpeta del c칩digo.

.. code-block::

    cd ~/raphael-kit/python-pi5

**Paso 4:** Ejecuta.

.. code-block::

    sudo python3 3.1.1_PhotographModule_zero.py

Despu칠s de que el c칩digo se ejecute, la c치mara tomar치 una foto. Ahora puedes ver la foto llamada ``my_photo.jpg`` en el directorio ``~``.

.. note::

    Tambi칠n puedes abrir ``3.1.1_PhotographModule.py`` en la ruta ``~/raphael-kit/python-pi5/`` con un IDE de Python, haz clic en el bot칩n Ejecutar para ejecutar y det칠n el c칩digo con el bot칩n Detener.

Si deseas descargar la foto a tu PC, consulta :ref:`filezilla`.

**C칩digo**

.. code-block:: python

   #!/usr/bin/env python3    
   from picamera2 import Picamera2, Preview
   import os

   # Obtener el nombre de usuario actual
   user = os.getlogin()
   # Obtener la ruta al directorio principal del usuario
   user_home = os.path.expanduser(f'~{user}')

   # Crear una instancia de Picamera2
   camera = Picamera2()
   # Recuperar la configuraci칩n predeterminada de previsualizaci칩n
   preview_config = camera.preview_configuration

   try:
       # Configurar tama침o y formato de previsualizaci칩n
       preview_config.size = (800, 600)
       preview_config.format = 'XRGB8888'  
       # Iniciar la previsualizaci칩n de la c치mara en modo QTGL
       camera.start_preview(Preview.QTGL)
       # Iniciar la c치mara
       camera.start()
       # Capturar y guardar una foto en el directorio principal del usuario
       camera.capture_file(f'{user_home}/my_photo.jpg')

   except KeyboardInterrupt:
       # Detener la previsualizaci칩n de la c치mara si ocurre una interrupci칩n de teclado (por ejemplo, Ctrl+C)
       camera.stop_preview()
       pass


**Explicaci칩n del C칩digo**

#. Importa las clases ``Picamera2`` y ``Preview`` de la biblioteca picamera2, y el m칩dulo ``os`` para interacciones con el sistema operativo.

   .. code-block:: python

       #!/usr/bin/env python3    
       from picamera2 import Picamera2, Preview
       import os

#. Recupera el nombre de usuario actual y la ruta a su directorio principal.

   .. code-block:: python

       # Obtener el nombre de usuario actual
       user = os.getlogin()
       # Obtener la ruta al directorio principal del usuario
       user_home = os.path.expanduser(f'~{user}')

#. Crea una instancia de la clase ``Picamera2`` y recupera la configuraci칩n predeterminada de previsualizaci칩n.

   .. code-block:: python

       # Crear una instancia de Picamera2
       camera = Picamera2()
       # Recuperar la configuraci칩n predeterminada de previsualizaci칩n
       preview_config = camera.preview_configuration

#. Configura el tama침o y formato de la previsualizaci칩n de la c치mara. El tama침o se establece en 800x600 p칤xeles y el formato en ``XRGB8888``.

   .. code-block:: python

       try:
           # Configurar tama침o y formato de previsualizaci칩n
           preview_config.size = (800, 600)
           preview_config.format = 'XRGB8888'

           ...

#. Inicia la previsualizaci칩n de la c치mara en modo QTGL y luego inicia la c치mara.

   .. code-block:: python

       try:
           ...
           
           # Iniciar la previsualizaci칩n de la c치mara en modo QTGL
           camera.start_preview(Preview.QTGL)
           # Iniciar la c치mara
           camera.start()

           ...

#. Captura una imagen con la c치mara, guard치ndola en ``~/``.

   .. code-block:: python

       try:
           ...           
           
           # Capturar y guardar una foto en el directorio principal del usuario
           camera.capture_file(f'{user_home}/my_photo.jpg')

   .. note::
       Puedes usar la funci칩n ``camera.capture()`` y un bucle ``for`` juntos para lograr una captura continua. Utiliza la funci칩n ``delay`` para ajustar el intervalo de tiempo entre las tomas.

       .. code-block:: python

           for i in 5:
               camera.capture(f'{user_home}/my_photo%s.jpg' % i)

#. Este bloque de c칩digo maneja una interrupci칩n de teclado (como Ctrl+C) deteniendo la previsualizaci칩n de la c치mara. La declaraci칩n ``pass`` se usa para manejar la excepci칩n sin hacer nada m치s.

   .. code-block:: python

       except KeyboardInterrupt:
           # Detener la previsualizaci칩n de la c치mara si ocurre una interrupci칩n de teclado (por ejemplo, Ctrl+C)
           camera.stop_preview()
           pass



