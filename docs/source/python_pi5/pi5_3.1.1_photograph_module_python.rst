.. note::

    隆Hola, bienvenido a la Comunidad de Entusiastas de SunFounder Raspberry Pi & Arduino & ESP32 en Facebook! Sum茅rgete m谩s en Raspberry Pi, Arduino y ESP32 con otros entusiastas.

    **驴Por qu茅 unirte?**

    - **Soporte experto**: Resuelve problemas postventa y desaf铆os t茅cnicos con la ayuda de nuestra comunidad y equipo.
    - **Aprende y comparte**: Intercambia consejos y tutoriales para mejorar tus habilidades.
    - **Avances exclusivos**: Obt茅n acceso anticipado a nuevos anuncios de productos y adelantos.
    - **Descuentos especiales**: Disfruta de descuentos exclusivos en nuestros productos m谩s nuevos.
    - **Promociones y sorteos festivos**: Participa en sorteos y promociones navide帽as.

     驴Listo para explorar y crear con nosotros? Haz clic en [|link_sf_facebook|] y 煤nete hoy mismo!

.. _3.1.1_py_pi5:

3.1.1 M贸dulo Fotogr谩fico
=============================

Introducci贸n
--------------------

En este kit, equipado con un m贸dulo de c谩mara, intentemos tomar una foto con Raspberry Pi.

Componentes Necesarios
-------------------------------

En este proyecto, necesitamos los siguientes componentes.

.. image:: ../python_pi5/img/3.3.1_photograph_list.png
  :width: 800

Es definitivamente conveniente comprar un kit completo, aqu铆 est谩 el enlace:

.. list-table::
    :widths: 20 20 20
    :header-rows: 1

    *   - Nombre	
        - ARTCULOS EN ESTE KIT
        - ENLACE
    *   - Kit Raphael
        - 337
        - |link_Raphael_kit|

Tambi茅n puedes comprarlos por separado en los enlaces a continuaci贸n.

.. list-table::
    :widths: 30 20
    :header-rows: 1

    *   - INTRODUCCIN DEL COMPONENTE
        - ENLACE DE COMPRA

    *   - :ref:`cpn_camera_module`
        - |link_camera_buy|

Procedimientos Experimentales
-------------------------------------

**Paso 1:** Accede al Escritorio de Raspberry Pi. Es posible que necesites una pantalla para una mejor experiencia, consulta: `Connect your Raspberry Pi <https://projects.raspberrypi.org/en/projects/raspberry-pi-setting-up/3>`_. O accede al escritorio de Raspberry Pi de forma remota, para un tutorial detallado consulta :ref:`remote_desktop`.

**Paso 2:** Abre una Terminal y ve a la carpeta del c贸digo.

.. code-block::

    cd ~/raphael-kit/python-pi5

**Paso 3:** Ejecuta.

.. code-block::

    sudo python3 3.1.1_PhotographModule_zero.py

Despu茅s de que el c贸digo se ejecute, la c谩mara tomar谩 una foto. Ahora puedes ver la foto llamada ``my_photo.jpg`` en el directorio ``~``.

.. note::

    Tambi茅n puedes abrir ``3.1.1_PhotographModule.py`` en la ruta ``~/raphael-kit/python-pi5/`` con un IDE de Python, haz clic en el bot贸n Ejecutar para ejecutar y det茅n el c贸digo con el bot贸n Detener.

Si deseas descargar la foto a tu PC, consulta :ref:`filezilla`.

.. warning::

    Si recibe el mensaje de error ``RuntimeError: Cannot determine SOC peripheral base address``, consulte :ref:`faq_soc`


**C贸digo**

.. code-block:: python

   #!/usr/bin/env python3    
   from picamera2 import Picamera2, Preview
   import os

   # Obtener el nombre de usuario actual
   user = os.getlogin()
   # Obtener la ruta al directorio principal del usuario
   user_home = os.path.expanduser(f'~{user}')

   # Crear una instancia de Picamera2
   camera = Picamera2()
   # Recuperar la configuraci贸n predeterminada de previsualizaci贸n
   preview_config = camera.preview_configuration

   try:
       # Configurar tama帽o y formato de previsualizaci贸n
       preview_config.size = (800, 600)
       preview_config.format = 'XRGB8888'  
       # Iniciar la previsualizaci贸n de la c谩mara en modo QTGL
       camera.start_preview(Preview.QTGL)
       # Iniciar la c谩mara
       camera.start()
       # Capturar y guardar una foto en el directorio principal del usuario
       camera.capture_file(f'{user_home}/my_photo.jpg')

   except KeyboardInterrupt:
       # Detener la previsualizaci贸n de la c谩mara si ocurre una interrupci贸n de teclado (por ejemplo, Ctrl+C)
       camera.stop_preview()
       pass


**Explicaci贸n del C贸digo**

#. Importa las clases ``Picamera2`` y ``Preview`` de la biblioteca picamera2, y el m贸dulo ``os`` para interacciones con el sistema operativo.

   .. code-block:: python

       #!/usr/bin/env python3    
       from picamera2 import Picamera2, Preview
       import os

#. Recupera el nombre de usuario actual y la ruta a su directorio principal.

   .. code-block:: python

       # Obtener el nombre de usuario actual
       user = os.getlogin()
       # Obtener la ruta al directorio principal del usuario
       user_home = os.path.expanduser(f'~{user}')

#. Crea una instancia de la clase ``Picamera2`` y recupera la configuraci贸n predeterminada de previsualizaci贸n.

   .. code-block:: python

       # Crear una instancia de Picamera2
       camera = Picamera2()
       # Recuperar la configuraci贸n predeterminada de previsualizaci贸n
       preview_config = camera.preview_configuration

#. Configura el tama帽o y formato de la previsualizaci贸n de la c谩mara. El tama帽o se establece en 800x600 p铆xeles y el formato en ``XRGB8888``.

   .. code-block:: python

       try:
           # Configurar tama帽o y formato de previsualizaci贸n
           preview_config.size = (800, 600)
           preview_config.format = 'XRGB8888'

           ...

#. Inicia la previsualizaci贸n de la c谩mara en modo QTGL y luego inicia la c谩mara.

   .. code-block:: python

       try:
           ...
           
           # Iniciar la previsualizaci贸n de la c谩mara en modo QTGL
           camera.start_preview(Preview.QTGL)
           # Iniciar la c谩mara
           camera.start()

           ...

#. Captura una imagen con la c谩mara, guard谩ndola en ``~/``.

   .. code-block:: python

       try:
           ...           
           
           # Capturar y guardar una foto en el directorio principal del usuario
           camera.capture_file(f'{user_home}/my_photo.jpg')

   .. note::
       Puedes usar la funci贸n ``camera.capture()`` y un bucle ``for`` juntos para lograr una captura continua. Utiliza la funci贸n ``delay`` para ajustar el intervalo de tiempo entre las tomas.

       .. code-block:: python

           for i in 5:
               camera.capture(f'{user_home}/my_photo%s.jpg' % i)

#. Este bloque de c贸digo maneja una interrupci贸n de teclado (como Ctrl+C) deteniendo la previsualizaci贸n de la c谩mara. La declaraci贸n ``pass`` se usa para manejar la excepci贸n sin hacer nada m谩s.

   .. code-block:: python

       except KeyboardInterrupt:
           # Detener la previsualizaci贸n de la c谩mara si ocurre una interrupci贸n de teclado (por ejemplo, Ctrl+C)
           camera.stop_preview()
           pass



