.. nota::

    隆Hola, bienvenido a la comunidad de entusiastas de SunFounder Raspberry Pi, Arduino y ESP32 en Facebook! Sum茅rgete m谩s en Raspberry Pi, Arduino y ESP32 con otros entusiastas.

    **驴Por qu茅 unirse?**

    - **Soporte experto**: Resuelve problemas post-venta y desaf铆os t茅cnicos con la ayuda de nuestra comunidad y equipo.
    - **Aprende y comparte**: Intercambia consejos y tutoriales para mejorar tus habilidades.
    - **Previews exclusivos**: Obt茅n acceso anticipado a nuevos anuncios de productos y adelantos.
    - **Descuentos especiales**: Disfruta de descuentos exclusivos en nuestros productos m谩s recientes.
    - **Promociones y sorteos festivos**: Participa en sorteos y promociones festivas.

     驴Listo para explorar y crear con nosotros? 隆Haz clic en [|link_sf_facebook|] y 煤nete hoy!

.. _2.1.5_py:

2.1.5 Interruptor de Inclinaci贸n
======================================

Introducci贸n
----------------

Este es un interruptor de inclinaci贸n de bola con una bola met谩lica 
en su interior. Se utiliza para detectar inclinaciones de un peque帽o 谩ngulo.

Componentes Necesarios
------------------------------

En este proyecto, necesitamos los siguientes componentes. 

.. image:: ../img/list_2.1.3_tilt_switch.png

Es definitivamente conveniente comprar un kit completo, aqu铆 est谩 el enlace: 

.. list-table::
    :widths: 20 20 20
    :header-rows: 1

    *   - Nombre	
        - ELEMENTOS EN ESTE KIT
        - ENLACE
    *   - Kit Raphael
        - 337
        - |link_Raphael_kit|

Tambi茅n puedes comprarlos por separado en los enlaces a continuaci贸n.

.. list-table::
    :widths: 30 20
    :header-rows: 1

    *   - INTRODUCCIN AL COMPONENTE
        - ENLACE DE COMPRA

    *   - :ref:`cpn_gpio_extension_board`
        - |link_gpio_board_buy|
    *   - :ref:`cpn_breadboard`
        - |link_breadboard_buy|
    *   - :ref:`cpn_wires`
        - |link_wires_buy|
    *   - :ref:`cpn_resistor`
        - |link_resistor_buy|
    *   - :ref:`cpn_led`
        - |link_led_buy|
    *   - :ref:`cpn_tilt_switch`
        - \-

Diagrama Esquem谩tico
-------------------------

.. image:: ../img/image307.png


.. image:: ../img/image308.png


Procedimientos Experimentales
-----------------------------------

**Paso 1:** Construir el circuito.

.. image:: ../img/image169.png

**Paso 2:** Cambiar el directorio.

.. raw:: html

   <run></run>

.. code-block:: 

    cd ~/raphael-kit/python/

**Paso 3:** Ejecutar.

.. raw:: html

   <run></run>

.. code-block:: 

    sudo python3 2.1.5_Tilt.py

Coloca el interruptor de inclinaci贸n verticalmente y el LED verde se encender谩. 
Si lo inclinas, se imprimir谩 "隆Inclinaci贸n!" en la pantalla y el LED rojo se encender谩. 
Vuelve a colocarlo verticalmente y el LED verde se encender谩 de nuevo.

**C贸digo**

.. nota::

    Puedes **Modificar/Restablecer/Copiar/Ejecutar/Detener** el c贸digo a continuaci贸n. Pero antes de eso, necesitas ir a la ruta del c贸digo fuente como ``raphael-kit/python``. Despu茅s de modificar el c贸digo, puedes ejecutarlo directamente para ver el efecto.

.. raw:: html

    <run></run>

.. code-block:: python

    import RPi.GPIO as GPIO

    TiltPin = 17
    Gpin   = 27
    Rpin   = 22

    def setup():
        GPIO.setmode(GPIO.BCM)       # Numerar GPIOs por ubicaci贸n f铆sica
        GPIO.setup(Gpin, GPIO.OUT)     # Establecer el modo del pin del LED verde como salida
        GPIO.setup(Rpin, GPIO.OUT)     # Establecer el modo del pin del LED rojo como salida
        GPIO.setup(TiltPin, GPIO.IN, pull_up_down=GPIO.PUD_UP)    # Establecer el modo del pin de inclinaci贸n como entrada y activar resistencia pull-up
        GPIO.add_event_detect(TiltPin, GPIO.BOTH, callback=detect, bouncetime=200)

    def Led(x):
        if x == 0:
            GPIO.output(Rpin, 1)
            GPIO.output(Gpin, 0)
        if x == 1:
            GPIO.output(Rpin, 0)
            GPIO.output(Gpin, 1)

    def Print(x):
        if x == 0:
            print ('    *************')
            print ('    *   Tilt!   *')
            print ('    *************')

    def detect(chn):
        Led(GPIO.input(TiltPin))
        Print(GPIO.input(TiltPin))

    def loop():
        while True:
            pass

    def destroy():
        GPIO.output(Gpin, GPIO.HIGH)       # Apagar LED verde
        GPIO.output(Rpin, GPIO.HIGH)       # Apagar LED rojo
        GPIO.cleanup()                     # Liberar recursos

    if __name__ == '__main__':     # El programa empieza aqu铆
        setup()
        try:
            loop()
        except KeyboardInterrupt:  # Cuando se presiona 'Ctrl+C', se ejecutar谩 la funci贸n destroy()
            destroy()

**Explicaci贸n del C贸digo**

.. code-block:: python

    GPIO.add_event_detect(TiltPin, GPIO.BOTH, callback=detect, bouncetime=200)

Configurar la detecci贸n en TiltPin, y la funci贸n de callback detect.

.. code-block:: python

    def Led(x):
        if x == 0:
            GPIO.output(Rpin, 1)
            GPIO.output(Gpin, 0)
        if x == 1:
            GPIO.output(Rpin, 0)
            GPIO.output(Gpin, 1)

Definir una funci贸n Led() para encender o apagar los dos LEDs. Si x=0, el LED rojo se enciende; de lo contrario, el LED verde se encender谩.

.. code-block:: python

    def Print(x):
        if x == 0:
            print ('    *************')
            print ('    *   Tilt!   *')
            print ('    *************')

Crear una funci贸n Print() para imprimir los caracteres en la pantalla.

.. code-block:: python

    def detect(chn):
        Led(GPIO.input(TiltPin))
        Print(GPIO.input(TiltPin))

Definir una funci贸n de callback para la inclinaci贸n. 
Obtener el valor le铆do del interruptor de inclinaci贸n, 
luego la funci贸n Led() controla el encendido o apagado 
de los dos LEDs dependiendo del valor le铆do del interruptor 
de inclinaci贸n.

Imagen del Fen贸meno
----------------------

.. image:: ../img/image170.jpeg


