.. note::

    隆Hola, bienvenido a la Comunidad de Entusiastas de SunFounder Raspberry Pi, Arduino y ESP32 en Facebook! Profundiza en Raspberry Pi, Arduino y ESP32 con otros entusiastas.

    **驴Por qu茅 unirse?**

    - **Soporte experto**: Resuelve problemas postventa y desaf铆os t茅cnicos con la ayuda de nuestra comunidad y equipo.
    - **Aprende y comparte**: Intercambia consejos y tutoriales para mejorar tus habilidades.
    - **Previews exclusivos**: Accede anticipadamente a anuncios de nuevos productos y adelantos exclusivos.
    - **Descuentos especiales**: Disfruta de descuentos exclusivos en nuestros productos m谩s recientes.
    - **Promociones y sorteos festivos**: Participa en sorteos y promociones de temporada.

     驴Listo para explorar y crear con nosotros? Haz clic en [|link_sf_facebook|] y 煤nete hoy mismo.

.. _3.1.1_py:

3.1.1 M贸dulo Fotogr谩fico
============================

Introducci贸n
-------------------

En este kit, equipado con un m贸dulo de c谩mara, vamos a intentar tomar una foto con Raspberry Pi.

Componentes necesarios
---------------------------------

En este proyecto, necesitamos los siguientes componentes. 

.. image:: ../img/photo1.png
  :width: 800

Es definitivamente conveniente comprar un kit completo, aqu铆 est谩 el enlace: 

.. list-table::
    :widths: 20 20 20
    :header-rows: 1

    *   - Nombre	
        - ELEMENTOS EN ESTE KIT
        - ENLACE
    *   - Kit Raphael
        - 337
        - |link_Raphael_kit|

Tambi茅n puedes comprarlos por separado en los enlaces a continuaci贸n.

.. list-table::
    :widths: 30 20
    :header-rows: 1

    *   - INTRODUCCIN DEL COMPONENTE
        - ENLACE DE COMPRA

    *   - :ref:`cpn_camera_module`
        - |link_camera_buy|

Procedimientos experimentales
---------------------------------

**Paso 1:** Accede al escritorio de Raspberry Pi. Puede que necesites una pantalla para una mejor experiencia, consulta: `Conecta tu Raspberry Pi <https://projects.raspberrypi.org/en/projects/raspberry-pi-setting-up/3>`_. O accede al escritorio de Raspberry Pi de forma remota, para un tutorial detallado, consulta :ref:`remote_desktop`.

**Paso 2:** Abre un terminal y accede a la carpeta del c贸digo.

.. code-block::

    cd ~/raphael-kit/python/

**Paso 3:** Ejecuta el c贸digo.

.. code-block::

    sudo python3 3.1.1_PhotographModule.py

Despu茅s de ejecutar el c贸digo, la c谩mara tomar谩 una foto. Ahora puedes ver la foto llamada ``my_photo.jpg`` en el directorio ``~``.

.. note::

    Tambi茅n puedes abrir ``3.1.1_PhotographModule.py`` en la ruta ``~/raphael-kit/python/`` con un IDE de Python, hacer clic en el bot贸n de Ejecutar para ejecutar el c贸digo y detenerlo con el bot贸n de Detener.


Si deseas descargar la foto a tu PC, consulta :ref:`filezilla`.

**C贸digo**


.. code-block:: python


    #!/usr/bin/env python3
    from picamera2 import Picamera2, Preview
    import os

    # Get the current user's login name
    user = os.getlogin()
    # Get the path to the user's home directory
    user_home = os.path.expanduser(f'~{user}')

    # Create a Picamera2 instance
    camera = Picamera2()
    # Retrieve the default preview configuration
    preview_config = camera.preview_configuration

    try:
        # Set preview size and format
        preview_config.size = (800, 600)
        preview_config.format = 'XRGB8888'
        # Start the camera preview in QTGL mode
        camera.start_preview(Preview.QTGL)
        # Start the camera
        camera.start()
        # Capture and save a photo to the user's home directory
        camera.capture_file(f'{user_home}/my_photo.jpg')

    except KeyboardInterrupt:
        # Stop the camera preview if a KeyboardInterrupt (e.g., Ctrl+C) occurs
        camera.stop_preview()
        pass

**Explicaci贸n del c贸digo**

#. Importa las clases ``Picamera2`` y ``Preview`` de la biblioteca picamera2, y el m贸dulo ``os`` para interacciones con el sistema operativo.

   .. code-block:: python

       #!/usr/bin/env python3    
       from picamera2 import Picamera2, Preview
       import os

#. Obtiene el nombre de inicio de sesi贸n del usuario actual y la ruta a su directorio personal.

   .. code-block:: python

       # Obtener el nombre de usuario actual
       user = os.getlogin()
       # Obtener la ruta al directorio personal del usuario
       user_home = os.path.expanduser(f'~{user}')

#. Crea una instancia de ``Picamera2`` y recupera la configuraci贸n predeterminada de vista previa.

   .. code-block:: python

       # Crear una instancia de Picamera2
       camera = Picamera2()
       # Recuperar la configuraci贸n predeterminada de la vista previa
       preview_config = camera.preview_configuration

#. Establece el tama帽o y el formato de la vista previa de la c谩mara.  
   El tama帽o se establece en 800x600 p铆xeles y el formato en ``XRGB8888``.

   .. code-block:: python

       try:
           # Establecer tama帽o y formato de la vista previa
           preview_config.size = (800, 600)
           preview_config.format = 'XRGB8888'

           ...

#. Inicia la vista previa de la c谩mara en modo QTGL, un m茅todo para mostrar la vista previa, y luego inicia la c谩mara.

   .. code-block:: python

       try:
           ...
           
           # Iniciar la vista previa en modo QTGL
           camera.start_preview(Preview.QTGL)
           # Iniciar la c谩mara
           camera.start()

           ...

#. Captura una imagen desde la c谩mara y la guarda en ``~/``.

   .. code-block:: python

       try:
           ...           
           
           # Capturar y guardar una foto en el directorio personal del usuario
           camera.capture_file(f'{user_home}/my_photo.jpg')

   .. note::
       Puedes usar la funci贸n ``camera.capture()`` junto con un bucle ``for`` para lograr disparos continuos.  
       Usa la funci贸n ``delay`` para ajustar el intervalo de tiempo entre fotos.

       .. code-block:: python

           for i in 5:
               camera.capture(f'{user_home}/my_photo%s.jpg' % i)

#. Este bloque de c贸digo maneja una interrupci贸n de teclado (como Ctrl+C) deteniendo la vista previa de la c谩mara.  
   La instrucci贸n ``pass`` se utiliza para manejar la excepci贸n sin realizar ninguna acci贸n adicional.

   .. code-block:: python

       except KeyboardInterrupt:
           # Detener la vista previa si ocurre un KeyboardInterrupt (ej., Ctrl+C)
           camera.stop_preview()
           pass
