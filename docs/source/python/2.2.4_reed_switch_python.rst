.. note::

    ã“ã‚“ã«ã¡ã¯ã€SunFounderã®Raspberry Pi & Arduino & ESP32æ„›å¥½å®¶ã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã¸ã‚ˆã†ã“ãï¼Facebookä¸Šã§Raspberry Piã€Arduinoã€ESP32ã«ã¤ã„ã¦ã‚‚ã£ã¨æ·±ãæ˜ã‚Šä¸‹ã’ã€ä»–ã®æ„›å¥½å®¶ã¨äº¤æµã—ã¾ã—ã‚‡ã†ã€‚

    **å‚åŠ ã™ã‚‹ç†ç”±ã¯ï¼Ÿ**

    - **ã‚¨ã‚­ã‚¹ãƒ‘ãƒ¼ãƒˆã‚µãƒãƒ¼ãƒˆ**ï¼šã‚³ãƒŸãƒ¥ãƒ‹ãƒ†ã‚£ã‚„ãƒãƒ¼ãƒ ã®åŠ©ã‘ã‚’å€Ÿã‚Šã¦ã€è²©å£²å¾Œã®å•é¡Œã‚„æŠ€è¡“çš„ãªèª²é¡Œã‚’è§£æ±ºã—ã¾ã™ã€‚
    - **å­¦ã³ï¼†å…±æœ‰**ï¼šãƒ’ãƒ³ãƒˆã‚„ãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«ã‚’äº¤æ›ã—ã¦ã‚¹ã‚­ãƒ«ã‚’å‘ä¸Šã•ã›ã¾ã—ã‚‡ã†ã€‚
    - **ç‹¬å çš„ãªãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼**ï¼šæ–°è£½å“ã®ç™ºè¡¨ã‚„å…ˆè¡Œãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ã«æ—©æœŸã‚¢ã‚¯ã‚»ã‚¹ã—ã¾ã—ã‚‡ã†ã€‚
    - **ç‰¹åˆ¥å‰²å¼•**ï¼šæœ€æ–°è£½å“ã®ç‹¬å å‰²å¼•ã‚’ãŠæ¥½ã—ã¿ãã ã•ã„ã€‚
    - **ç¥­ã‚Šã®ãƒ—ãƒ­ãƒ¢ãƒ¼ã‚·ãƒ§ãƒ³ã¨ã‚®ãƒ•ãƒˆ**ï¼šã‚®ãƒ•ãƒˆã‚„ç¥æ—¥ã®ãƒ—ãƒ­ãƒ¢ãƒ¼ã‚·ãƒ§ãƒ³ã«å‚åŠ ã—ã¾ã—ã‚‡ã†ã€‚

    ğŸ‘‰ ç§ãŸã¡ã¨ä¸€ç·’ã«æ¢ç´¢ã—ã€å‰µé€ ã™ã‚‹æº–å‚™ã¯ã§ãã¦ã„ã¾ã™ã‹ï¼Ÿ[|link_sf_facebook|]ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ä»Šã™ãå‚åŠ ã—ã¾ã—ã‚‡ã†ï¼

.. _2.2.4_py:

2.2.4 ãƒªãƒ¼ãƒ‰ã‚¹ã‚¤ãƒƒãƒãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«
==============================

ã¯ã˜ã‚ã«
-------------------

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã¯ã€ç£å ´ãŒä½œç”¨ã™ã‚‹ã“ã¨ã§å‹•ä½œã™ã‚‹é›»æ°—ã‚¹ã‚¤ãƒƒãƒã§ã‚ã‚‹ãƒªãƒ¼ãƒ‰ã‚¹ã‚¤ãƒƒãƒã«ã¤ã„ã¦å­¦ã³ã¾ã™ã€‚

.. image:: ../img/2.2.4reed_switch.png
    :width: 300
    :align: center

å¿…è¦ãªéƒ¨å“
------------------------------

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§å¿…è¦ãªã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ã€‚

.. image:: ../img/2.2.4component.png
    :width: 700
    :align: center

ä¸€å¼ã‚’ã¾ã¨ã‚ã¦è³¼å…¥ã™ã‚‹ã¨ç¢ºå®Ÿã«ä¾¿åˆ©ã§ã™ã€‚ãƒªãƒ³ã‚¯ã¯ã“ã¡ã‚‰ï¼š

.. list-table::
    :widths: 20 20 20
    :header-rows: 1

    *   - åå‰	
        - ã“ã®ã‚­ãƒƒãƒˆã®ã‚¢ã‚¤ãƒ†ãƒ 
        - ãƒªãƒ³ã‚¯
    *   - Raphael Kit
        - 337
        - |link_Raphael_kit|

ä»¥ä¸‹ã®ãƒªãƒ³ã‚¯ã‹ã‚‰å€‹åˆ¥ã«è³¼å…¥ã™ã‚‹ã“ã¨ã‚‚ã§ãã¾ã™ã€‚

.. list-table::
    :widths: 30 20
    :header-rows: 1

    *   - ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®ç´¹ä»‹
        - è³¼å…¥ãƒªãƒ³ã‚¯

    *   - :ref:`cpn_gpio_board`
        - |link_gpio_board_buy|
    *   - :ref:`cpn_breadboard`
        - |link_breadboard_buy|
    *   - :ref:`cpn_wires`
        - |link_wires_buy|
    *   - :ref:`cpn_resistor`
        - |link_resistor_buy|
    *   - :ref:`cpn_led`
        - |link_led_buy|
    *   - :ref:`cpn_reed_switch`
        - |link_reed_switch_buy|

å›è·¯å›³
-----------------------

============ ======== ======== ===
T-Board Name physical wiringPi BCM
GPIO17       ãƒ”ãƒ³11     0          17
GPIO27       ãƒ”ãƒ³13     2          27
GPIO22       ãƒ”ãƒ³15     3          22
============ ======== ======== ===

.. image:: ../img/reed_schematic.png
    :width: 400
    :align: center

.. image:: ../img/reed_schematic2.png
    :width: 400
    :align: center

å®Ÿé¨“æ‰‹é †
-------------------------------

**ã‚¹ãƒ†ãƒƒãƒ—1:** å›è·¯ã‚’çµ„ã‚€ã€‚

.. image:: ../img/2.2.4fritzing.png
    :width: 700
    :align: center

**ã‚¹ãƒ†ãƒƒãƒ—2:** ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã‚’å¤‰æ›´ã™ã‚‹ã€‚

.. raw:: html

   <run></run>

.. code-block::

    cd ~/raphael-kit/python/

**ã‚¹ãƒ†ãƒƒãƒ—3:** å®Ÿè¡Œã™ã‚‹ã€‚

.. raw:: html

   <run></run>

.. code-block::

    sudo python3 2.2.4_ReedSwitch.py

ã‚³ãƒ¼ãƒ‰ãŒå®Ÿè¡Œã•ã‚Œã‚‹ã¨ã€ç·‘ã®LEDãŒç‚¹ç¯ã—ã¾ã™ã€‚ãƒªãƒ¼ãƒ‰ã‚¹ã‚¤ãƒƒãƒãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã«ç£çŸ³ã‚’è¿‘ã¥ã‘ã‚‹ã¨ã€èµ¤ã„LEDãŒç‚¹ç¯ã—ã¾ã™ã€‚ç£çŸ³ã‚’é›¢ã™ã¨ã€ç·‘ã®LEDãŒå†ã³ç‚¹ç¯ã—ã¾ã™ã€‚

**ã‚³ãƒ¼ãƒ‰**

.. note::

    ä¸‹è¨˜ã®ã‚³ãƒ¼ãƒ‰ã¯ **å¤‰æ›´/ãƒªã‚»ãƒƒãƒˆ/ã‚³ãƒ”ãƒ¼/å®Ÿè¡Œ/åœæ­¢** ãŒå¯èƒ½ã§ã™ã€‚ãŸã ã—ã€äº‹å‰ã«ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®ãƒ‘ã‚¹ã€ä¾‹ãˆã° ``raphael-kit/python`` ã«ç§»å‹•ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ã‚³ãƒ¼ãƒ‰ã‚’ä¿®æ­£ã—ãŸå¾Œã€ãã®åŠ¹æœã‚’ç›´æ¥ç¢ºèªã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

.. raw:: html

    <run></run>

.. code-block:: python

    #!/usr/bin/env python3
    import RPi.GPIO as GPIO
    import time

    ReedPin = 17
    Gpin    = 27
    Rpin    = 22

    def setup():
        GPIO.setmode(GPIO.BCM)       # 
        GPIO.setup(Gpin, GPIO.OUT)     # Set Green Led Pin mode to output
        GPIO.setup(Rpin, GPIO.OUT)     # Set Red Led Pin mode to output
        GPIO.setup(ReedPin, GPIO.IN, pull_up_down=GPIO.PUD_UP)    # Set ReedPin's mode is input, and pull up to high level(3.3V)
        GPIO.add_event_detect(ReedPin, GPIO.BOTH, callback=detect, bouncetime=200)

    def Led(x):
        if x == 0:
            GPIO.output(Rpin, 1)
            GPIO.output(Gpin, 0)
        if x == 1:
            GPIO.output(Rpin, 0)
            GPIO.output(Gpin, 1)

    def detect(self):
        Led(GPIO.input(ReedPin))

    def loop():
        while True:
            pass

    def destroy():
        GPIO.output(Gpin, GPIO.HIGH)       # Green led on
        GPIO.output(Rpin, GPIO.LOW)       # Red led off
        GPIO.cleanup()                     # Release resource

    if __name__ == '__main__':     # Program start from here
        setup()
        detect()
        try:
            loop()
        except KeyboardInterrupt:  # When 'Ctrl+C' is pressed, the child program destroy() will be  executed.
            destroy()

**ã‚³ãƒ¼ãƒ‰ã®èª¬æ˜**

.. code-block:: python

    ReedPin = 17
    Gpin    = 27
    Rpin    = 22

    def setup():
        GPIO.setmode(GPIO.BCM)       # 
        GPIO.setup(Gpin, GPIO.OUT)     # Set Green Led Pin mode to output
        GPIO.setup(Rpin, GPIO.OUT)     # Set Red Led Pin mode to output
        GPIO.setup(ReedPin, GPIO.IN, pull_up_down=GPIO.PUD_UP)    # Set ReedPin's mode is input, and pull up to high level(3.3V)
        GPIO.add_event_detect(ReedPin, GPIO.BOTH, callback=detect, bouncetime=200)

GPIOãƒ¢ãƒ¼ãƒ‰ã‚’BCMãƒŠãƒ³ãƒãƒªãƒ³ã‚°ã«è¨­å®šã—ã¾ã™ã€‚ ``ReedPin`` ã€ ``Gpin`` ã€ ``Rpin`` ã¯ã€ãã‚Œãã‚ŒGPIO17ã€GPIO27ã€GPIO22ã«æ¥ç¶šã•ã‚Œã¦ã„ã¾ã™ã€‚

``GPIO.add_event_detect()`` ã¯ã€ ``ReedPin`` ã®å€¤ï¼ˆãƒ¬ãƒ™ãƒ«ï¼‰ãŒå¤‰æ›´ã•ã‚ŒãŸéš›ã«ãƒˆãƒªã‚¬ãƒ¼ã•ã‚Œã‚‹ã‚¤ãƒ™ãƒ³ãƒˆã‚’è¿½åŠ ã™ã‚‹ãŸã‚ã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚ã“ã®éš›ã€ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•° ``detect()`` ãŒå‘¼ã³å‡ºã•ã‚Œã¾ã™ã€‚

.. code-block:: python

    def Led(x):
        if x == 0:
            GPIO.output(Rpin, 1)
            GPIO.output(Gpin, 0)
        if x == 1:
            GPIO.output(Rpin, 0)
            GPIO.output(Gpin, 1)

``Led()`` ã¨ã„ã†é–¢æ•°ã‚’å®šç¾©ã—ã¦ã€2ã¤ã®LEDã‚’ã‚ªãƒ³ã¾ãŸã¯ã‚ªãƒ•ã«ã—ã¾ã™ã€‚ ``x=0`` ã®å ´åˆã€èµ¤ã„LEDãŒç‚¹ç¯ã—ã¾ã™ã€‚ãã‚Œä»¥å¤–ã®å ´åˆã€ç·‘ã®LEDãŒç‚¹ç¯ã—ã¾ã™ã€‚

.. code-block:: python

    def detect(self):
    Led(GPIO.input(ReedPin))

ã“ã®ã‚³ãƒ¼ãƒ«ãƒãƒƒã‚¯é–¢æ•°ã§ã¯ã€ãƒªãƒ¼ãƒ‰ã‚¹ã‚¤ãƒƒãƒã®å€¤ã‚’ç”¨ã„ã¦2ã¤ã®LEDã‚’åˆ¶å¾¡ã—ã¾ã™ã€‚

ç¾è±¡ã®ç”»åƒ
------------------------

.. image:: ../img/2.2.4reed_switch.JPG
    :width: 500
    :align: center